#!/bin/bash
# -*- coding: utf-8 -*-
#
# Univention Management Console
#  test commands for the UVMM UMC module
#
# Copyright 2011 Univention GmbH
#
# http://www.univention.de/
#
# All rights reserved.
#
# The source code of this program is made available
# under the terms of the GNU Affero General Public License version 3
# (GNU AGPL V3) as published by the Free Software Foundation.
#
# Binary versions of this program provided by Univention to you as
# well as other copyrighted, protected or trademarked materials like
# Logos, graphics, fonts, specific documentations and configurations,
# cryptographic keys etc. are subject to a license agreement between
# you and Univention and not subject to the GNU AGPL V3.
#
# In the case you use this program under the terms of the GNU AGPL V3,
# the program is provided in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public
# License with the Debian GNU/Linux or Univention distribution in file
# /usr/share/common-licenses/AGPL-3; if not, see
# <http://www.gnu.org/licenses/>.
#!/bin/sh

eval "$(ucr shell hostname domainname)"

# list groups
umc-client -U root -P univention command uvmm/group/query

# list nodes
umc-client -U root -P univention command uvmm/node/query -o group=default -o pattern="*"

# query domains of node
umc-client -U root -P univention command uvmm/domain/query -o nodePattern=qemu://$hostname.$domainname/system -o domainPattern="*"

# query domains of ALL node
umc-client -U root -P univention command uvmm/domain/query -o nodePattern="*" -o domainPattern="*"

# get domain details
umc-client -U root -P univention command uvmm/domain/get -o "nodeURI=qemu://slave.ucs3.test/system" -o "domainUUID=66e90830-b46b-39c2-873a-8d649f10a011"

# start a domain
umc-client -U root -P univention command uvmm/domain/state -o nodeURI=qemu://$hostname.$domainname/system -o domainUUID="70ebb8c8-1229-bf60-c0b6-77638ecd35bf" -o domainState=RUN

# navigation: elements without parent (groups)
umc-client -U root -P univention command uvmm/nav/query -e -o "{ 'parent' : None }"

# navigation: elements under a group (nodes)
umc-client -U root -P univention command uvmm/nav/query -e -o "{ 'parent' : { 'id' : 'default', 'type' : 'group' } }"
