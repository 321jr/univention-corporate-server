From: Jan Beulich <jbeulich@suse.com>
Date: Wed, 16 Sep 2015 15:48:46 +0200
Subject: CVE-2015-4106.5 xen/pt: mark all PCIe capability bits read-only

xen_pt_emu_reg_pcie[]'s PCI_EXP_DEVCAP needs to cover all bits as read-
only to avoid unintended write-back (just a precaution, the field ought
to be read-only in hardware).

This is a preparatory patch for XSA-131.

Signed-off-by: Jan Beulich <jbeulich@suse.com>
Reviewed-by: Stefano Stabellini <stefano.stabellini@eu.citrix.com>
Source: http://xenbits.xen.org/xsa/xsa131-qemut-5.patch
---
 tools/ioemu-qemu-xen/hw/pass-through.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tools/ioemu-qemu-xen/hw/pass-through.c b/tools/ioemu-qemu-xen/hw/pass-through.c
index a693a24..4ed11cc 100644
--- a/tools/ioemu-qemu-xen/hw/pass-through.c
+++ b/tools/ioemu-qemu-xen/hw/pass-through.c
@@ -558,7 +558,7 @@ static struct pt_reg_info_tbl pt_emu_reg_pcie_tbl[] = {
         .offset     = PCI_EXP_DEVCAP,
         .size       = 4,
         .init_val   = 0x00000000,
-        .ro_mask    = 0x1FFCFFFF,
+        .ro_mask    = 0xFFFFFFFF,
         .emu_mask   = 0x10000000,
         .init       = pt_common_reg_init,
         .u.dw.read  = pt_long_reg_read,
