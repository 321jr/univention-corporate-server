From: Andrew Cooper <andrew.cooper3@citrix.com>
Date: Tue, 21 Apr 2015 09:27:07 +0200
Subject: CVE-2015-3340 domctl/sysctl: don't leak hypervisor stack to
 toolstacks

This is CVE-2015-3340 / XSA-132.

Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Acked-by: Ian Campbell <ian.campbell@citrix.com>
master commit: 4ff3449f0e9d175ceb9551d3f2aecb59273f639d
master date: 2015-04-21 09:03:15 +0200
Commit-4.2: 7e527e2ab6c95ef84035d02e9e50b956a0d469c9
---
 xen/arch/x86/domctl.c | 2 +-
 xen/common/sysctl.c   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/xen/arch/x86/domctl.c b/xen/arch/x86/domctl.c
index 24e2c04..d4590cb 100644
--- a/xen/arch/x86/domctl.c
+++ b/xen/arch/x86/domctl.c
@@ -1250,7 +1250,7 @@ long arch_do_domctl(
     case XEN_DOMCTL_gettscinfo:
     {
         struct domain *d;
-        xen_guest_tsc_info_t info;
+        xen_guest_tsc_info_t info = { 0 };
 
         ret = -ESRCH;
         d = rcu_lock_domain_by_id(domctl->domain);
diff --git a/xen/common/sysctl.c b/xen/common/sysctl.c
index 5365c20..2746cb5 100644
--- a/xen/common/sysctl.c
+++ b/xen/common/sysctl.c
@@ -101,7 +101,7 @@ long do_sysctl(XEN_GUEST_HANDLE(xen_sysctl_t) u_sysctl)
     case XEN_SYSCTL_getdomaininfolist:
     { 
         struct domain *d;
-        struct xen_domctl_getdomaininfo info;
+        struct xen_domctl_getdomaininfo info = { 0 };
         u32 num_domains = 0;
 
         rcu_read_lock(&domlist_read_lock);
