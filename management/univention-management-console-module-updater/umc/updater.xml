<?xml version="1.0" encoding="UTF-8"?>
<umc version="2.0">
  <module id="updater" icon="updater" version="1.0">
	<name>Online Update</name>
	<description>Online Software Update</description>
	<categories>
	  <category name="system"/>
	</categories>

	<!--
		ONLINE/COMPONENTS namespace: drives the components grid
		and the associated 'component details' form.
	 -->
	<!-- QUERY: return a list of components, along with their status -->
	<command name="updater/components/query" function="query_components"/>
	<!-- SERIAL: an interface to track changedness -->
	<command name="updater/components/serial" function="serial"/>
	<!-- GET: retrieve one element with this ID -->
	<command name="updater/components/get" function="get_components">
		<!-- TODO: specify the arg list that umcpModuleStore.get() gives to us -->
	</command>
	<!-- PUT: write back settings for one component -->
	<command name="updater/components/put" function="put_components">
		<attribute name="enabled" syntax="Boolean"/>
		<attribute name="name" syntax="String"/>
		<attribute name="description" syntax="String"/>
		<attribute name="server" syntax="String"/>
		<attribute name="prefix" syntax="String"/>
		<attribute name="maintained" syntax="Boolean"/>
		<attribute name="unmaintained" syntax="Boolean"/>
		<attribute name="username" syntax="String"/>
		<attribute name="password" syntax="String"/>
	</command>
	<!-- DEL: remove the given component -->
	<command name="updater/components/del" function="del_components"/>

	<!--
		ONLINE/UPDATES namespace: to fetch the elements of
		the overview 'updates' page.
	 -->
	<!-- GET: the only call really needed -->
	<command name="updater/updates/get" function="status"/>
	<!-- QUERY: to fill the 'available releases' ComboBox -->
	<command name="updater/updates/query" function="query_releases"/>
	<!-- SERIAL: check if something has changed. -->
	<command name="updater/updates/serial" function="updates_serial"/>
	<!-- AVAILABLE: check if there are component updates. -->
	<command name="updater/updates/available" function="updates_available"/>
	<!-- CHECK: return a list of packages eligible for update/install -->
	<command name="updater/updates/check" function="updates_check"/>

	<!--
		ONLINE/SETTINGS namespace: to fetch and write settings. Even if this
		is not really a tabular namespace, we treat it this way, and will
		always get/set the first and only 'record'.
	 -->
	<!-- GET: retrieve the settings. -->
	<command name="updater/settings/get" function="get_settings"/>
	<!-- PUT: write back settings. -->
	<command name="updater/settings/put" function="put_settings">
		<attribute name="server" syntax="String"/>
		<attribute name="prefix" syntax="String"/>
		<attribute name="maintained" syntax="Boolean"/>
		<attribute name="unmaintained" syntax="Boolean"/>
		<attribute name="hotfixes" syntax="Boolean"/>
	</command>

	<!--
		ONLINE/INSTALLER namespace:
		 - to execute any actions that install/update something
		 - to get notified when an installer job is being started
		 - to check if a job is finished
		 - to watch the log file
	 -->
	<!-- EXECUTE: start any installer/updater action -->
	<command name="updater/installer/execute" function="run_installer">
		<attribute name="job" syntax="Online-Install-Job"/>
		<attribute name="detail" syntax="String"/>
	</command>
	<!-- REBOOT: does what it says. -->
	<command name="updater/installer/reboot" function="reboot"/>
	<!-- RUNNING: return job key while an installer job is running -->
	<command name="updater/installer/running" function="running"/>
	<!-- LOGFILE: read <count> log lines (count=0 -> all, count=-1 -> log timestamp) -->
	<command name="updater/installer/logfile" function="updater_log_file">
		<attribute name="job" syntax="Online-Install-Job"/>
		<attribute name="count" syntax="Integer"/>
	</command>
	<!-- STATUS: get job status, even if job has finished -->
	<command name="updater/installer/status" function="updater_job_status">
		<attribute name="job" syntax="Online-Install-Job"/>
	</command>
  </module>
</umc>
