<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<style type="text/css">
		@import url("../js/dijit/themes/umc/umc.css");
		@import url("style.css");
	</style>
	<script type="text/javascript">
		var dojoConfig = {
			has: {
				'dojo-undef-api': true
			},
			isDebug: true,
			async: true,
			deps: [
				"dojo/_base/lang",
				"dojo/_base/array",
				"dojo/_base/window",
				"dojo/dom",
				"dojo/dom-construct",
				"dojo/dom-style",
				"dojo/on",
				"dojo/Stateful",
				"dijit/layout/StackContainer",
				"dijit/form/Button",
				"dijit/form/Textarea",
				"umc/tools",
				"umc/widgets/Text",
				"umc/widgets/TextBox",
				"umc/widgets/Form",
				"umc/widgets/CheckBox",
				"umc/widgets/ComboBox",
				"umc/widgets/ContainerWidget",
				"umc/widgets/MultiInput",
				"umc/widgets/LabelPane",
				"umc/widgets/Uploader",
				"dojox/lang/functional/object",
				"dojo/domReady!"
			],
			callback: function(lang, array, win, dom, domConstruct, domStyle, on, Stateful, StackContainer, Button, TextArea, tools, Text, TextBox, Form, CheckBox, ComboBox, ContainerWidget, MultiInput, LabelPane, Uploader, obj) {
				domStyle.set('overlay', 'display', 'none');

				var values = [ 'green', 'blue', 'yellow', 'red', 'purple', 'pink', 'orange', 'transparent'],

				_multiInputValues = [ {type: TextBox,name: "multiLine1", description: "??", label: "Line1", size:"Half", intermediateChanges: true}, {type: TextBox, name: "multiLine2", description: "??", label: "Line2", size:"Half", intermediateChanges: true} ];


				this.buttons = [{
					name: 'labelButton1',
					type: Button,
					label: "Change Label",
					description: 'Do it!',
					onClick:	function() {
						setLabels('Someting');
					}
				}, {
					name: 'labelButton2',
					type: Button,
					label: "Change Label again",
					description: 'Do it!',
					onClick:	function() {
						setLabels('Something else');
					}
				}, {
					name: 'descButton',
					type: Button,
					label: "change description",
					onClick:	function() {
						setDescriptions('!!!!!!!');
					}
				}, {
					name: 'desc2Button',
					type: Button,
					label: 'change description again',
					onClick:	function() {
						setDescriptions('?');
					}
				}, {
					name: 'deleteButton',
					type: Button,
					label: "Remove tooltips",
					onClick: function() {
						setDescriptions(null);
					}
				}];


				// widgets inside container
				this.widgets = [{
					type: Text,
					name: 'muliText',
					label: "MultiInput"
				} ,{
					type: MultiInput,
					name: 'multi',
					subtypes: [{
						type: TextBox,
						description: "??",
						label: "Line1",
						size: 'Half'
					}, {
						type: TextBox,
						description: "??",
						label: "Line2",
						size: 'Half'
					}],
					label: 'MultiInput2',
					_setDescription: function(description) {
						dojo.forEach(this._widgets, function(lines) {
							dojo.forEach(lines, function (subWidget) {
								subWidget.set('description', description);
							});
						});
					},
				}, {
					name: 'multi2',
					type: MultiInput,
					subtypes: [{
						type: TextBox,
						description: "??",
						label: "Line1"
					}],
					size: "Half",
					label: 'MultiInput2',
					_setDescription: function(description) {
						dojo.forEach(this._widgets, function(lines) {
							dojo.forEach(lines, function (subWidget) {
								subWidget.set('description', description);
							});
						});
					},
				}, {
					type: Text,
					name: 'uploadText',
					label: "Uploader"
				} ,{
					type: Uploader,
					name: 'uploader',
					label: "This is a uploader",
					description: "This is a description of the uploader"
				}, {
					type: Text,
					name: 'checkText',
					label: "Checkbox"
				}, {
					type: CheckBox,
					name: 'check',
					label: 'Checkbox',
					description: 'Check to remove tooltip',
					onClick: function() {
						this.set('description', null);
					}

				}, {
					type: TextArea,
					name: 'text',
					label: 'Tooltip will change if you type someting into the box',
					description: 'Text',
					onKeyUp: function() {
						stuff = this.value;
						console.debug(stuff);
						this.set('description', stuff);
					}
				}, {
					type: ComboBox,
					name: 'ComboBox1',
					label: 'Colours',
					description: ' A Box',
					_showlabel: true,
					staticValues: values
				}];


				var form = new Form({
					buttons: buttons,
					widgets: widgets
				});


				form.placeAt(win.body());
				form.startup();

				// helper function to get a widget by its name,
				// returns the widget object
				getWidgetByName = function(widgetName) {
					var allWidgets =  dijit.registry._hash;
					var result = null;
					array.forEach(obj.keys(allWidgets), function(iwidget) {
						if (allWidgets[iwidget].name == widgetName) {
							result =  allWidgets[iwidget];
						}
					});
					return result;
				};

				getWidgets = function() {
					var widgetsArray = [];
					var widgetNames = ['multi', 'multi2', 'check', 'uploader', 'ComboBox1'];
					dojo.forEach(widgetNames, function(widget) {
						widgetsArray.push(getWidgetByName(widget));
					});
					return widgetsArray;
				};

				setDescriptions = function(description) {
					dojo.forEach(getWidgets(), function(widget) {
						if (typeof widget._setDescription == 'function') {
							widget._setDescription(description);
						} else {
							widget.set('description', description);
						}
					});
				};

				setLabels = function(label) {
					dojo.forEach(getWidgets(), function(widget) {
						if (typeof widget.label == 'Array') {
							widget.set('label', [label, label]);
						} else {
							widget.set('label', label);
						}
					});
				};
			}
		};

		</script>
	<script type="text/javascript" src="../js/dojo/dojo.js"></script>
</head>
<body class="umc">
	<div id="overlay"></div>
	<div id='content'></div>
</body>
</html>
