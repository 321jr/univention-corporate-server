#!/usr/share/ucs-test/runner python
## desc: Try excecuting udm users/user list as Administrator
## tags: [udm-users]
## roles:
##   - domaincontroller_master
##   - domaincontroller_backup
## exposure: secure
## packages:
##   - univention-directory-manager-tools


import sys
import subprocess

if __name__ == '__main__':
	udm = subprocess.Popen(['su', 'Administrator', '-c', '/usr/sbin/univention-directory-manager users/user list --filter uid=Administrator'], stdout=subprocess.PIPE)

	if udm.wait() != 0 or not 'DN: uid=Administrator' in udm.stdout.read():
		sys.exit(110) # udm has returned an error or did not successfully print the Administrator object to stdout

	sys.exit(0) # nothing went wrong, test passed



