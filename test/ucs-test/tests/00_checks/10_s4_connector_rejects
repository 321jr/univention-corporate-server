#!/usr/share/ucs-test/runner python
## desc: Check for S4 connector rejected objects
## exposure: safe
## bugs: [37011, 37324]
## packages:
## - univention-s4-connector

from subprocess import Popen, PIPE

import univention.testing.utils as utils


print "Looking for S4 connector rejects:"

proc = Popen('univention-s4connector-list-rejected', stdout=PIPE, stderr=PIPE)
stdout, stderr = proc.communicate()

if stderr.strip():
    utils.fail("An error occured while running "
               " 'univention-s4connector-list-rejected'. STDERR: %r" % stderr)

if not stdout.strip():
    utils.fail("The 'univention-s4connector-list-rejected' did not produce "
               "any output to STDOUT.")

print stdout

if ("UCS DN" in stdout) or ("S4 DN" in stdout):
    utils.fail("S4 Connector rejects were found.")
