[Global]
# These settings can be overwritten by the instance
logfile: ~/ec2/logfiles/singlemaster-test-kvm.log

kvm_server: isala
kvm_architecture: amd64
kvm_ucsversion: 3.1-1
kvm_template: generic
kvm_interface: eth0

[singlemaster-test]
profile:
 hostname="ucs"
 domainname="test.local"
 windows/domain="TEST"
 ldap/base="dc=test,dc=local"
 root_password="univention"
 locale/default="de_DE.UTF-8:UTF-8"
 packages_install="univention-s4-connector univention-samba4"
 packages_remove=""
 eth0_acceptra="false"
 eth0_ip="10.200.99.2"
 eth0_netmask="255.255.255.0"
 eth0_network="10.200.99.0"
 eth0_broadcast="10.200.99.255"
 gateway="10.200.99.1"
 nameserver_1="192.168.0.3"
command1:
 echo -e "#!/bin/sh\nroute del default ; route add default gw 10.210.216.13" >>/etc/network/if-up.d/z_route
 chmod +x /etc/network/if-up.d/z_route
 /etc/network/if-up.d/z_route
 ucr set updater/identify="UCS (EC2 Test)"
command2:
 ucr set repository/online/server=testing.univention.de
 univention-upgrade --noninteractive --ignoressh --ignoreterm
 # Workaround for Bug #31561
 sleep 10
 univention-upgrade --noninteractive --ignoreterm --ignoressh
command3:
 mv /var/cache/univention-system-setup/profile.bak /var/cache/univention-system-setup/profile || true
 /usr/lib/univention-system-setup/scripts/setup-join.sh
command4:
 reboot
 LOCAL sleep 40
command5:
 ucr set repository/online/unmaintained=true
 univention-install --yes ucs-test
 ucr set repository/online/unmaintained=false
 ucs-test -E dangerous -s base
command6:
 LOCAL mkdir -p ~/ec2/testresult/singlemaster-test-kvm
 LOCAL scp root@[singlemaster-test_IP]:/var/log/univention/test* ~/ec2/testresult/singlemaster-test-kvm/
# files: 

