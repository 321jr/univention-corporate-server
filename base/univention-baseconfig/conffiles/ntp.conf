# Warning: This file is auto-generated and might be overwritten by
#          univention-config-registry.
#          Please edit the following file instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch
#          univention-config-registry Ã¼berschrieben werden.
#          Bitte bearbeiten Sie an Stelle dessen die folgende Datei:
#
# 	/etc/univention/templates/files/etc/ntp.conf
#

# /etc/ntp.conf, configuration for ntpd

# ntpd will use syslog() if logfile is not defined
#logfile /var/log/ntpd

driftfile /var/lib/ntp/ntp.drift
statsdir /var/log/ntpstats/

statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable


@!@
if not (configRegistry.has_key('timeserver') and configRegistry['timeserver'] == 'local'):
	if configRegistry.has_key('server/role') and configRegistry['server/role'] != "domaincontroller_master":
		if configRegistry.has_key('ldap/master') and configRegistry['ldap/master']:
			print 'server %s' % configRegistry['ldap/master']
		if configRegistry.has_key('ldap/backup') and configRegistry['ldap/backup']:
			backup=configRegistry['ldap/backup'].split(' ')
			fqdn=configRegistry['hostname']+'.'+configRegistry['domainname']
			for i in range(0,len(backup)):
				if backup[i] != fqdn and backup[i] != "":
					print 'server %s' % backup[i]
	if configRegistry.has_key('timeserver') and configRegistry['timeserver']:
		print 'server %s' % configRegistry['timeserver']
	if configRegistry.has_key('timeserver2') and configRegistry['timeserver2']:
		print 'server %s' % configRegistry['timeserver2']
	if configRegistry.has_key('timeserver3') and configRegistry['timeserver3']:
		print 'server %s' % configRegistry['timeserver3']
@!@

### Synchronize with local server, if no other
### could be reached

server 127.127.1.0
@!@
if configRegistry.has_key('server/role') and configRegistry['server/role'] == 'domaincontroller_master':
	if configRegistry.has_key('timeserver') and configRegistry['timeserver'] == 'local':
		print 'fudge 127.127.1.0 stratum 1'
	else:
		print 'fudge 127.127.1.0 stratum 10'
else:
	print 'fudge 127.127.1.0 stratum 15'
@!@

