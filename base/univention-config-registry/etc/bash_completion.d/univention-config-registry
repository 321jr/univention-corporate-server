# bash completion for univention-config-registry
# bugs: - does not recognize options

_univention-config-registry()
{
	file=/etc/univention/base.conf
	COMPREPLY=()
	cur=${COMP_WORDS[COMP_CWORD]}
	prev=${COMP_WORDS[COMP_CWORD-1]}

	if [ "$prev" = "commit" ]; then
		_filedir
	else
		if [ "$cur" = "" ]; then
			vars=$(grep -v \# $file | grep -v ^$ | sed "s/:.*//")
			COMPREPLY=($vars)
		else
			vars=$(grep ^$cur $file | sed "s/:.*//")
			COMPREPLY=($vars)
		fi
	fi
	return 0
}

complete -F _univention-config-registry univention-config-registry
complete -F _univention-config-registry univention-baseconfig

