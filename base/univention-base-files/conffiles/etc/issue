@!@
# Warning: This file is auto-generated and might be overwritten by
#          univention-config-registry.
#          Please edit the following file instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch
#          univention-config-registry
#          Bitte bearbeiten Sie an Stelle dessen die folgende Datei:
#
#       /etc/univention/templates/files/etc/issue
#

menutitle=''
serversystem=False
recommend_ussnet=False

if   configRegistry['server/role'] == 'fatclient':
	menutitle="Univention Managed Client"
elif configRegistry['server/role'] =='mobileclient':
	menutitle="Univention Mobile Client"
elif configRegistry['server/role'] =='domaincontroller_master':
	menutitle="Univention DC Master"
	serversystem=True
elif configRegistry['server/role'] =='domaincontroller_backup':
	menutitle="Univention DC Backup"
	serversystem=True
elif configRegistry['server/role'] =='domaincontroller_slave':
	menutitle="Univention DC Slave"
	serversystem=True
elif configRegistry['server/role'] =='memberserver':
	menutitle="Univention Memberserver"
	serversystem=True
else:
	menutitle="Univention Corporate Server"

if configRegistry.get('version/version'):
	print  '%s %s-%s-%s' % (menutitle, configRegistry['version/version'], configRegistry['version/patchlevel'], configRegistry['version/security-patchlevel'])
else:
	print 'Univention Thin Client'

if serversystem:
	for device in ['eth0', 'eth1', 'eth2', 'eth3']:
		type=configRegistry.get('interfaces/%s/type' % device)
		if type == 'dhcp':
			fallback_address=configRegistry.get('interfaces/%s/fallback/address' % device)
			if fallback_address:
		  		current_address=configRegistry.get('interfaces/%s/address' % device )
		  		if current_address != fallback_address:
					print ''
					print 'Warning: Network device %s currently uses the IP address "%s", obtained via dhcp,' % (device, current_address)
					print '         but it was setup with IP address "%s".' % fallback_address
					recommend_ussnet=True
	if recommend_ussnet:
		print ''
		print '         Please consider running univention-system-setup-net'
		print '         to update the information in the UCS directory service.'
		print ''
@!@
