#!/usr/bin/make -f

VERSION = 2.1.1
URL = git://github.com/ariya/phantomjs.git
DIR := phantomjs-src
TAR := phantomjs_$(VERSION).orig.tar.gz

get-orig-source: $(TAR)
$(TAR): $(DIR)
	tar -c -z -f $@ --exclude .git $<

$(DIR):
	git clone --recursive --branch $(VERSION) $(URL) $@

override_dh_auto_build: $(DIR)
	cd $(DIR) && python build.py --confirm --release

override_dh_auto_clean: $(DIR)
	cd $(DIR) && git clean -d -f -x
	cd $(DIR) && git submodule foreach 'git clean -d -f -x'

%:
	dh $@
