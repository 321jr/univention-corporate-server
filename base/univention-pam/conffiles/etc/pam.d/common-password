# Warning: This file is auto-generated and might be overwritten by 
#          univention-baseconfig.
#          Please edit the following file instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch 
#          univention-baseconfig Ã¼berschrieben werden. 
#          Bitte bearbeiten Sie an Stelle dessen die folgende Datei:
# 
# 	/etc/univention/templates/files/etc/pam.d/common-password
# 
password requisite  pam_cracklib.so
@!@
methods=filter(lambda(x): x in ['krb5', 'ldap', 'winbind'], baseConfig['auth/user/methods'].split(' '))
isneeded="sufficient"
if len(methods)==0:
	isneeded="required"
print 'password %s pam_unix.so nullok obscure md5 min=4 max=32 use_first_pass'%isneeded 
if 'krb5' in methods:
	methods.remove('krb5')
	if len(methods)==0:
	    isneeded="required"
	print 'password %s pam_krb5.so use_first_pass'%isneeded
if 'ldap' in methods:
	methods.remove('ldap')
	if len(methods)==0:
	    isneeded="required"
	print 'password %s pam_ldap.so use_first_pass'%isneeded
if 'winbind' in methods:
	methods.remove('winbind')
	if len(methods)==0:
	    isneeded="required"
	print 'password %s pam_winbind.so use_first_pass use_authok'%isneeded
@!@
