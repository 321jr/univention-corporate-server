@%@UCRWARNING=# @%@

@include common-auth

# Sets the loginuid process attribute
session    required     pam_loginuid.so

# Read environment variables from pam_env's default files, /etc/environment
# and /etc/security/pam_env.conf.
session       required   pam_env.so

# In addition, read system locale information
session       required   pam_env.so envfile=/etc/default/locale

@!@
scope = "cron"
accessfileFlag = "auth/%s/restrict" % (scope,)
if configRegistry.is_true(accessfileFlag, False):
	accessfileDefault = "/etc/security/access-%s.conf" % (scope,)
	accessfileKey = "auth/%s/accessfile" % (scope,)
	accessfile = configRegistry.get(accessfileKey, accessfileDefault)
	line =  [
		'account required pam_access.so',
		'accessfile=%s' % (accessfile,),
		'listsep=,',
		]
	maxent = configRegistry.get('pamaccess/maxent', False)
	if maxent:
		line.append('maxent=%s' % (maxent,))
	print ' '.join(line)
@!@
@include common-account
@include common-session-noninteractive 

# Sets up user limits, please define limits for cron tasks
# through /etc/security/limits.conf
session    required   pam_limits.so

