@%@UCRWARNING=# @%@
#
# The PAM configuration file for the Shadow `chsh' service
#

# This will not allow a user to change their shell unless
# their current one is listed in /etc/shells. This keeps
# accounts with special shells from changing them.
auth       required   pam_shells.so

# This allows root to change user shell without being
# prompted for a password
auth		sufficient	pam_rootok.so

# The standard Unix authentication modules, used with
# NIS (man nsswitch) as well as normal /etc/passwd and
# /etc/shadow entries.
@include common-auth
@!@
scope = "chsh"
accessfileFlag = "auth/%s/restrict" % (scope,)
if configRegistry.is_true(accessfileFlag, False):
	accessfileDefault = "/etc/security/access-%s.conf" % (scope,)
	accessfileKey = "auth/%s/accessfile" % (scope,)
	accessfile = configRegistry.get(accessfileKey, accessfileDefault)
	line =  [
		'account required pam_access.so',
		'accessfile=%s' % (accessfile,),
		'listsep=,',
		]
	maxent = configRegistry.get('pamaccess/maxent', False)
	if maxent:
		line.append('maxent=%s' % (maxent,))
	print ' '.join(line)
@!@
@include common-account
@include common-session

