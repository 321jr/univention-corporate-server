@%@UCRWARNING=# @%@

@!@
import os.path
certificate = configRegistry.get('saml/idp/certificate/certificate', '')
if os.path.isfile(certificate):
	print "Alias /simplesamlphp/saml2/idp/certificate %s" % (certificate,)
@!@
Alias /simplesamlphp /usr/share/simplesamlphp/www

@!@
if configRegistry.is_true('saml/idp/https'):
	print '''RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^/?simplesamlphp/(.*) https://%{SERVER_NAME}/simplesamlphp/$1 [R,L]
'''
@!@

<Directory /usr/share/simplesamlphp/www/>
	Order allow,deny
	Allow from all
	php_admin_value suhosin.get.max_value_length "2048"
</Directory>

@!@
sso_fqdn = configRegistry.get('ucs/server/sso/fqdn', 'ucs-sso.%s' % configRegistry.get('domainname'))
ssofqdn = {'ssofqdn': sso_fqdn}
import os.path
if os.path.isfile('/etc/univention/ssl/%(ssofqdn)s/cert.pem' % ssofqdn) and os.path.isfile('/etc/univention/ssl/%(ssofqdn)s/private.key' % ssofqdn):
	print '''
<IfModule mod_ssl.c>
<VirtualHost *:443>
	SSLEngine on
	SSLProxyEngine on
	ServerName %(ssofqdn)s
	SSLCertificateFile /etc/univention/ssl/%(ssofqdn)s/cert.pem
	SSLCertificateKeyFile /etc/univention/ssl/%(ssofqdn)s/private.key
	SSLCACertificateFile /etc/univention/ssl/ucsCA/CAcert.pem
</VirtualHost>
</IfModule>
''' % ssofqdn
@!@
