product: ucs
release: "4.2"
version: [4]
scope: ucs_4.2-0-errata4.2-4
src: libmspack
fix: 0.5-1.A~4.2.4.201808101752
desc: |
 This update addresses the following issues:
 * mspack/lzxd.c in libmspack 0.5alpha, as used in ClamAV 0.99.2, allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted CHM file. (CVE-2017-6419)
 * The cabd_read_string function in mspack/cabd.c in libmspack 0.5alpha, as used in ClamAV 0.99.2 and other products, allows remote attackers to cause a denial of service (stack-based buffer over-read and application crash) via a crafted CAB file. (CVE-2017-11423)
 * An issue was discovered in mspack/chmd.c in libmspack before 0.7alpha. There is an off-by-one error in the CHM PMGI/PMGL chunk number validity checks, which could lead to denial of service (uninitialized data dereference and application crash). (CVE-2018-14679)
 * An issue was discovered in mspack/chmd.c in libmspack before 0.7alpha. It does not reject blank CHM filenames. (CVE-2018-14680)
 * An issue was discovered in kwajd_read_headers in mspack/kwajd.c in libmspack before 0.7alpha. Bad KWAJ file header extensions could cause a one or two byte overwrite. (CVE-2018-14681)
 * An issue was discovered in mspack/chmd.c in libmspack before 0.7alpha. There is an off-by-one error in the TOLOWER() macro for CHM decompression. (CVE-2018-14682)

 0.5-1+deb8u2 (Mon, 06 Aug 2018 17:01:04 +0800) * Non-maintainer upload. * Add security related patches: - 0b0ef9344255 ("kwaj_read_headers(): fix handling of non-terminated strings") CVE-2018-14681 (Closes: 904799). - 4fd9ccaa54e1 ("Fix off-by-one error in chmd TOLOWER() fallback") CVE-2018-14682 (Closes: 904800). - 72e70a921f0f ("Fix off-by-one bounds check on CHM PMGI/PMGL chunk numbers and reject empty filenames.") CVE-2018-14679, CVE-2018-14680 (Closes: 904802, 904801).

 0.5-1+deb8u1 (Wed, 16 Aug 2017 21:42:50 +0200) * Correct rejection of empty strings. * Fix mis-handling of sys->read() errors in cabd_read_string() (CVE-2017-11423). * Reject negative output length in SpanInfo (CVE-2017-6419)
 .
 * CVE-2017-6419 libmspack, clamav: heap-based buffer overflow in mspack/lzxd.c (CVE-2017-6419)
 * CVE-2017-11423 libmspack, clamav: Stack-based buffer over-read in cabd_read_string function (CVE-2017-11423)
 * CVE-2018-14679 libmspack: off-by-one error in the CHM PMGI/PMGL chunk number validity checks (CVE-2018-14679)
 * CVE-2018-14680 libmspack: off-by-one error in the CHM chunk number validity checks (CVE-2018-14680)
 * CVE-2018-14681 libmspack: Out-of-bounds Write in kwajd_read_headers in mspack/kwajd.c (CVE-2018-14681)
 * CVE-2018-14682 libmspack: off-by-one error in the TOLOWER() macro for CHM decompression (CVE-2018-14682)
bug: [47575]
cve:
- CVE-2017-6419
- CVE-2017-11423
- CVE-2018-14679
- CVE-2018-14680
- CVE-2018-14681
- CVE-2018-14682
