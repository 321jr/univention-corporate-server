%autobuild=true changelog

\input{handbuch_pdf_1}

\newcommand{\ucsManualTitle}{UCS 3.2 Release Notes}
\newcommand{\ucsManualSubtitle}{Release Notes für die Inbetriebnahme und
Aktualisierung von Univention Corporate Server (UCS) 3.2}
\newcommand{\ucsManualVersion}{3.2}
\newcommand{\ucsTechAuthor}{ & Univention GmbH & feedback@univention.de}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\input{handbuch_pdf_2}

\chapter{Release-Highlights}

Mit Univention Corporate Server 3.2 steht das zweite Point-Release für
Univention Corporate Server (UCS) zur Verfügung. Es umfasst
diverse Detailverbesserungen und Fehlerkorrekturen:

\begin{itemize}
\item TODO % TODO
\end{itemize}

\chapter{Empfohlene Update-Reihenfolge für Umgebungen mit mehr als einem UCS-Server / Update von Systemen mit UCS-Komponenten}

In Umgebungen mit mehr als einem UCS-System muss die Update-Reihenfolge der
UCS-Systeme beachtet werden:

Auf dem \ucsMaster{} wird die maßgebliche (authoritative) Version des
LDAP-Verzeichnis"=dienstes vorgehalten, die an alle übrigen LDAP-Server
der UCS-Domäne repliziert wird. Da bei Release-Updates Veränderungen
an den LDAP-Schemata auftreten können (siehe
Kapitel 3.4.1 des Handbuchs \cite{UCS-Handbuch}) muss der \ucsMaster{} bei einem
Release-Update immer als erstes System aktualisiert werden.

Generell ist es empfehlenswert alle UCS-Systeme möglichst in einem
Wartungsfenster zu aktualisieren.

\section{Hinweise zu Umgebungen mit anderer Dritt-Software}

Bei der Verwendung von 3rd-Party-Software ist generell \emph{vor} dem Update
mit dem Hersteller/Vertriebspartner der Software zu klären, ob
diese mit der neuen Version von Univention Corporate Server weiterhin
uneingeschränkt einsetzbar ist. 

Die Hersteller/Vertriebspartner von auf Univention Corporate Server
basierenden Produkten sorgen eigenständig für die Veröffentlichung. Updates
müssen daher von dort bezogen werden.

Falls Ihnen von Univention angepasste Paketversionen bereitgestellt wurden, so
sollte geprüft werden, ob durch die Aktualisierung angepasste Pakete
überschrieben werden --- vorzugsweise in einer Testumgebung. Sollten Sie hier
Probleme feststellen, so wenden Sie sich bitte an Univention.

\chapter{Vorbereitung des Updates}
Es sollte geprüft werden, ob ausreichend Festplattenplatz verfügbar ist. Eine
Standard-Installation benötigt min. 6 GB Speicherplatz. Das
Update benötigt je nach Umfang der vorhanden Installation mindestens 1 GB
weiteren Speicherplatz zum Herunterladen und Installieren der Pakete.

Für das Update sollte eine Anmeldung auf der Console mit dem
Benutzer \emph{root} durchgeführt und das Update dort gestartet werden.
Alternativ kann das Update über die \ucsUMC{} durchgeführt werden.

Eine Remote-Aktualisierung über SSH wird nicht empfohlen, da dies
beispielsweise bei Unterbrechung der Netzverbindung zum Abbruch des
Update-Vorgangs und zu einer Beeinträchtigung des Systems führen kann. Sollte
dennoch eine Aktualisierung über eine Netzverbindung durchgeführt werden, ist
sicherzustellen, dass das Update bei Unterbrechung der Netzverbindung trotzdem
weiterläuft. Hierfür können beispielsweise die Tools \ucsCommand{screen} oder
\ucsCommand{at} eingesetzt werden, die auf allen Systemrollen installiert sind.

\section{System mit dem cyrus IMAP Server (univention-mail-cyrus)}

\subsection{Cyrus Datenbank Konfiguration}

Mit UCS 3.2 wird von
\ucsName{univention-mail-cyrus} ein neues \ucsUCR{} Template
\ucsURL{/var/lib/cyrus/db/DB_CONFIG} für die Konfiguration der cyrus DBD
Datenbank installiert. Default-Werte für die cyrus DB\_CONFIG sind:

\texttt{mail/cyrus/bdb/dbconfig/set\_lg\_regionmax=\symbol{34}2097152\symbol{34}}\newline
\texttt{mail/cyrus/bdb/dbconfig/set\_cachesize=\symbol{34}0 2097152 1\symbol{34}}

Eine bereits vorhandene cyrus DBD Konfiguration wird während des Update nach
\ucsURL{/var/lib/cyrus/db/DB_CONFIG.debian} kopiert. Sollten die neuen
Default-Werte den alten, bereits vorhandenen Konfiguration nicht entsprechen
oder sind verwendete Optionen nicht in den neuen Default-Werten vorhanden,
können die entsprechenden \ucsUCR{} Variablen vor dem Update gesetzt
werden, z.B.:

\ucsCommand{ucr set mail/cyrus/bdb/dbconfig/set\_cachesize=\symbol{34}0 4097152 1\symbol{34}}\newline
\ucsCommand{ucr set mail/cyrus/bdb/dbconfig/set\_lg\_regionmax=\symbol{34}2097152\symbol{34}}\newline
\ucsCommand{ucr set mail/cyrus/bdb/dbconfig/set\_lg\_max=\symbol{34}1048576\symbol{34}}

Nach dem Update würde sich daraus folgende \ucsURL{/var/lib/cyrus/db/DB\_CONFIG} ergeben:

\texttt{set\_cachesize 0 4097152 1\newline
set\_lg\_regionmax 2097152\newline
set\_lg\_max 1048576\newline
} 

\subsection{Cyrus Benutzermanagement}

Das Listener Modul für die Verwaltung der Postfächer wurde überarbeitet.
Postfächer werden nun nur noch angelegt, wenn das Attribut \emph{mailHomeServer} am
Benutzer gesetzt ist. Falls diese Attribut vom Benutzerobjekt entfernt wird,
wird das Postfach gelöscht (sofern
\texttt{mail/cyrus/mailbox/delete=\symbol{34}yes\symbol{34}} auf dem
Mailserver gesetzt ist.)

Bitte stellen Sie die Korrekheit des Attributes \emph{mailHomeServer} an den
Benutzerobjekten vor dem Update sicher.

\chapter{Nachbereitung des Updates}

Nach dem Update müssen die neuen oder aktualisierten Join-Skripte
ausgeführt werden. Dies kann auf zwei Wegen erfolgen: Entweder über
das UMC-Modul \ucsMenuEntry{Domänenbeitritt} oder durch Aufruf des
Befehls \ucsCommand{univention-run-join-scripts} als
Benutzer \emph{root}.

Anschließend sollte das UCS-System neu gestartet werden.

\section{Migration auf Grub 2}

Bei einer Neuinstallation ab UCS 3.0 wird vom Univention Installer direkt GRUB 2 in den
Bootsektor geschrieben.

Bei einem Update bleibt GRUB 1 im Master Boot Record (MBR) installiert. GRUB 2
richtet einen Eintrag ``Chainload into Grub'' ein, der dann das eigentliche
GRUB 2 lädt.

Eine Dokumentation, um auch auf aktualisierten Systemen Grub 2 direkt
in den MBR zu schreiben wird später bereitgestellt (\ucsBug{23544}).

\section{Migration von PostgreSQL 8.3 auf PostgreSQL 8.4}
Ab UCS 3.0 wird neben PostgreSQL 8.3 auch PostgreSQL 8.4
angeboten. Bei Aktualisierungen von Systemen mit PostgreSQL 8.3 auf
UCS 3.0 wird aber die installierte PostgreSQL Version beibehalten.

Das Update auf PostgreSQL 8.4 ist im
SDB-Artikel \ucsURL{http://sdb.univention.de/1220} beschrieben.

\chapter{Hinweise zum Einsatz einzelner Pakete}

\section{Erfassung von Nutzungsstatistiken bei Verwendung der Free-For-Personal-Use-Version}
Bei Verwendung der  \emph{Free for personal use}-Version
von UCS (die in der Regel für Evaluationen von UCS herangezogen wird)
werden anonyme Nutzungsstatistiken zur Verwendung der \ucsUMC{}
erzeugt. Die aufgerufenen Module werden dabei von einer Instanz des
Web-Traffic-Analyse-Tools Piwik protokolliert. Dies ermöglicht es
Univention die Entwicklung der \ucsUMC{} besser auf das
Kundeninteresse zuzuschneiden und Usability-Verbesserungen vorzunehmen.

Diese Protokollierung erfolgt nur bei Verwendung der 
Free-for-Personal-Use-Lizenz. Der Lizenzstatus kann durch einen
Klick auf das Zahnrad-Symbol in der rechten, oberen Ecke der \ucsUMC{}
und die Auswahl von \ucsMenuEntry{Lizenz} geprüft werden. Steht hier
unter \ucsMenuEntry{LDAP-Basis} \emph{Free for personal use edition}
wird eine solche Version verwendet. Bei Einsatz einer regulären
UCS-Lizenz erfolgt keine Nutzungsstatistik.

Die Protokollierung kann unabhängig von der verwendeten Lizenz durch
Setzen der \ucsUCR{}-Variable \ucsUCRVSA{umc/web/piwik}  auf \emph{false} deaktiviert
werden.

\section{Bootprobleme bei Verwendung der UEFI-Installations-DVD}
Ab UCS 3.1 steht für amd64 neben der Standard-Installations-DVD auch
ein Medium mit Unterstützung für den Unified Extensible Firmware
Interface-Standard (UEFI) bereit.

Auf Systemen, die nur einen UEFI-Start unterstützen, kann sie anstelle
der Standard-DVD verwendet werden.

\section{Umfang des Sicherheits-Supports von Webkit, Konqueror und QtWebKit}
Webkit, Konqueror und QtWebkit werden in UCS im maintained-Zweig des
Repositorys mitgeliefert, aber nicht durch Sicherheits-Updates
unterstützt. Webkit wird vor allem für die Darstellung von
HTML-Hilfeseiten u.ä. verwendet. Als Web-Browser sollte Firefox
eingesetzt werden.

\section{Empfohlene Browser für den Zugriff auf die Univention Management Console}

\ucsUMC{} verwendet für die Darstellung der Web-Oberfläche zahlreiche
Javascript- und CSS-Funktionen. Cookies müssen im Browser zugelassen
sein. Die folgenden Browser werden empfohlen:

\begin{itemize}
\item Chrome ab Version 14
\item Firefox ab Version 10
\item Internet Explorer ab Version 9
\item Safari (auf dem iPad 2)
\end{itemize}

Auf älteren Browsern können Darstellungs- oder Performanceprobleme
auftreten. Die Einrichtung einer aktuellen Firefox-Version unter UCD
3.1 ist im Univention Wiki \cite{ucd-firefox7} dokumentiert.

\section{Einschränkungen im Samba 4-Betrieb}

Die aktuell vom Samba-Projekt veröffentlichten Versionen von Samba 4
unterliegen in der Weiterentwicklung noch stärkeren Änderungen als Samba
3. Einige Funktionalitäten stehen daher noch nicht vollständig zur Verfügung:

\begin{itemize}
\item Microsoft Windows Domänencontroller dürfen aktuell nicht in eine Samba 4-Domäne
gejoint werden.
\item Eine selektive Replikation ist mit Samba 4 nicht möglich, da diese durch
Active Directory prinzipiell nicht unterstützt wird (in UCS@school
basiert die selektive Replikation auf der Listener/Notifier-Replikation).
\item Samba 4 unterstützt aktuell keine Forest-Domänen. 
\item Samba 4 unterstützt aktuell keine Vertrauensstellungen.
\end{itemize}

Weitere Hinweise finden sich in Kapitel 8 des UCS-Handbuchs \cite{UCS-Handbuch}.

\section{Installation in VirtualBox}
Bei der Installation von UCS in der Virtualisierungslösung VirtualBox vor Version 4.2 kann folgender Bug auftreten:
Wenn von der Installations-DVD gebotet wird bietet
GRUB die Option \ucsMenuEntry{Boot from first harddisk
partition} an. Wählt man diese Option aus, friert VirtualBox ein.

Als Workaround muß vor dem Neustart der UCS-VM entweder die
Installations-DVD aus den Laufwerkseinstellungen der VirtualBox-VM
entfernt werden oder beim Start der virtuellen Instanz F12 gedrückt
werden und die Festplatte als Bootpartition ausgewählt werden.

\section{Migration einer Samba 3-Umgebung auf Samba 4}
\label{samba-migration}

Es existieren zwei grundlegende Verfahren zur Migration von Samba 3 auf Samba
4:

\begin{itemize}
\item Aufbau einer parallelen Samba 4-Domäne. Beide Domänen verwenden
unterschiedliche NetBIOS-Namen und SIDs. Die Clients treten dann schrittweise
der Samba 4-Domäne bei.
\item Migration aller Systeme innerhalb eines Wartungsfensters.
\end{itemize}

Beide Verfahren sind im Univention Wiki ausführlich dokumentiert:
\ucsURL{http://wiki.univention.de/index.php?title=Migration_from_Samba_3_to_Samba_4}.

\section{Xen} % Bug #29296
Wenn der Xen Hypervisor benutzt wird und das Speicherlimit über die \ucsUCR{}-Variable \ucsUCRVSA{grub/xenhopt} begrenzt wurde, sollte der Wert aktualisiert und um die \texttt{,max:}-Angabe erweitert werden.
Weitere Details in der \href{http://wiki.univention.de/index.php?title=UVMM_Quickstart-3.1#Konfiguration_der_Dom0}{UVMM Quickstart Anleitung}.

\chapter{Changelog}

Die Changelogs mit den detaillierten Änderungsinformationen werden ab UCS 3.0
nur noch in Englisch gepflegt. Aufgeführt sind die Änderung seit UCS 3.1-1.

\input{changelog-3.2}

\input{bibtex}

\end{document}
