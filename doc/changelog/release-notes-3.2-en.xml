<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
          "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [

  <!ENTITY % entities SYSTEM "../stylesheets/macros-en.ent" >
  <!ENTITY bibliography SYSTEM "../stylesheets/bibliography-en.xml">
  <!ENTITY changelog SYSTEM "changelog-3.2.xml">

  %entities;
]>
<book lang="en" id="releasenotes-3.2-en">
    <bookinfo>
      <title>UCS 3.2 Release Notes</title>
      <subtitle>Release notes for the installation and update of Univention Corporate Server (UCS) 3.2</subtitle>

        <revhistory>
            <revision>
                <revnumber>3.2-0</revnumber>
                <date>16 Jul 2013</date>
            </revision>
        </revhistory>

		<legalnotice>
		  <para>
			Alle Rechte vorbehalten. / All rights reserved.
		  </para>

		  <para>
			(c) 2002 bis 2013 Univention GmbH
		  </para>

		  <para>
			Mary-Somerville-Straße 1, 28359 Bremen, Deutschland/Germany
		  </para>

		  <para>
			feedback@univention.de
		  </para>

		  <para>
			Jede aufgeführte Marke und jedes Warenzeichen steht im Eigentum
			ihrer jeweiligen eingetragenen Rechtsinhaber. Linux ist ein
			eingetragenes Warenzeichen von Linus Torvalds.
		  </para>

		  <para>
			The mentioned brand names and registered trademarks are owned by
			the respective legal owners in each case. Linux is a registered
			trademark of Linus Torvalds.
		  </para>
		</legalnotice>

    </bookinfo>

    <chapter id="relnotes:highlights">
	  <title>Release highlights</title>

		<para>
		  With Univention Corporate Server 3.2, the second minor release for Univention Corporate
		  Server (UCS) 3.1 is now available. It provides several improvements and bugfixes:
		</para>

		  <!-- <listitem><para> -->
		  <!-- 	Die &ucsUMC; bietet nun Single-Sign-On; mit einer Anmeldung kann auf verschiedene -->
		  <!-- 	UMC-Instanzen zugegriffen werden. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	SAML (Security Assertion Markup Language) ist ein XML-basierter Standard zum Austausch -->
		  <!-- 	von Authentifizierungsinformationen, der u.a. Single-Sign-On über Domänengrenzen hinweg -->
		  <!-- 	erlaubt. UCS stellt nun einen SAML Identity Provider bereit: Der externe Dienst -->
		  <!-- 	(z.B. Salesforce) wird dabei über ein kryptografisches Zertifikat fest registriert und -->
		  <!-- 	vertraut dann dem Identity Provider. Der Benutzer authentifiziert sich dann nur noch in -->
		  <!-- 	UCS und kann den eingebundenen Dienst ohne erneute Authentifizierung nutzen. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Das Univention App Center wurde weiter ausgebaut und bietet weitergehende -->
		  <!-- 	Integrationsmöglichkeiten für Drittanbieter (z.B. Relationen von Apps und optionale -->
		  <!-- 	Bestellfunktionen von Apps aus dem App Center). Auch die Standard-UCS-Komponenten werden -->
		  <!-- 	nur über das App Center verwaltet. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Samba 4 wurde auf Version 4.1 aktualisiert. SMB2 wird nun anstelle von CIFS als -->
		  <!-- 	bevorzugtes Protokoll für Dateidienste eingesetzt. Der Univention S4 Connector wurde -->
		  <!-- 	deutlich beschleunigt und die Synchronisation von Gruppen verbessert. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Bridges, Bondings und VLANs können nun auch in der &ucsUMC; konfiguriert werden. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Die unterliegende Debian-Version wurde auf Version 6.0.8 aktualisiert; dies bringt -->
		  <!-- 	zahlreiche Verbesserungen und Fehlerkorrekturen mit sich. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Der Linux-Kernel wurde auf 3.10.15 aktualisiert. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Die Bedienung der &ucsUMC; wurde an vielen Stellen optimiert und vereinfacht, z.B. gibt -->
		  <!-- 	es nun vereinfachte Assistente zum Anlegen von Benutzern und interne Systembenutzer -->
		  <!-- 	werden in der Grundeinstellung nicht mehr angezeigt. -->
		  <!-- </para></listitem> -->

		  <!-- <listitem><para> -->
		  <!-- 	Die Verwaltung von Freigaben wurde vereinfacht. Für NFS-Freigaben wird nun auch NFSv4 -->
		  <!-- 	unterstützt. -->
		  <!-- </para></listitem> -->

    </chapter>

    <chapter id="relnotes:order">
	  <title>Recommended update order for environments with more than one UCS server</title>

	  <para>
		In environments with more than one UCS system, the update order of the UCS systems must be
		borne in mind:
	  </para>

	  <para>
		The authoritative version of the LDAP directory service is maintained on the master domain
		controller and replicated on all the remaining LDAP servers of the UCS domain. As changes
		to the LDAP schemes can occur during release updates), the master domain controller must
		always be the first system to be updated during a release update.
	  </para>

	  <para>
		It is generally advisable to update all UCS systems in one maintenance window whenever
		possible.
	  </para>
	</chapter>

    <chapter id="relnotes:prepare">
	  <title>Preparation of update</title>

		<para>
		  It must be checked whether sufficient disk space is available. A standard installation
		  requires a minimum of 6 GB of memory. Depending on the scope of the existing installation,
		  the update will require at least another 1 GB of memory for the downloading and
		  installation of the packages.
		</para>

		<para>
		  For the update, a login should be performed on the console with the
		  <emphasis>root</emphasis> user and then the update started there. Alternatively, the
		  update can be initiated using the &ucsUMC;.
		</para>

		<para>
		  Remote updating via SSH is not recommended as this may result in the update procedure
		  being cancelled if the network connection is interrupted, for example, and this can affect
		  the system. If updating should occur over a network connection nevertheless, it must be
		  verified that the update continues despite disconnection from the network. This can be
		  done, for example, using the tools <command>screen</command> and <command>at</command>,
		  which are installed on all system roles.
		</para>

	  <section id="relnotes:bdb">
		<title>Checking the size of the BDB database of systems with Cyrus IMAP server (univention-mail-cyrus)</title>
		<para>
		  As of UCS 3.2, the univention-mail-cyrus package includes a new &ucsUCR; template for
		  the configuration file of the Cyrus BDB database (<filename>/var/lib/cyrus/db/DB_CONFIG</filename>).
		</para>

		<para>
		  The default values of the UCR variables for the configuration of the BDB database are:

		  <itemizedlist>
			<listitem><para>
			  mail/cyrus/bdb/dbconfig/set_lg_regionmax : "2097152"
			</para></listitem>

			<listitem><para>
			  mail/cyrus/bdb/dbconfig/set_cachesize : "0 2097152 1"
			</para></listitem>
		  </itemizedlist>
		</para>

		<para>
		  Any existing Cyrus BDB configuration will be copied to
		  <filename>/var/lib/cyrus/db/DB_CONFIG.debian</filename> during the update. If the new
		  default values do not correspond to the old, existing configuration or if the used options are
		  not available in the new default values, the corresponding &ucsUCR; variables should be
		  set prior to the update. E.g.:
		</para>

<programlisting language="sh">
ucr set mail/cyrus/bdb/dbconfig/set_cachesize="0 4097152 1"
ucr set mail/cyrus/bdb/dbconfig/set_lg_regionmax="2097152"
ucr set mail/cyrus/bdb/dbconfig/set_lg_max="1048576"
</programlisting>
	  </section>

	  <section id="relnotes:cyruslistener">
		<title>Updates to the Univention Directory listener module for Cyrus users</title>
		<para>
		  The listener module for the administration of mailboxes has been revised. Mailboxes are
		  now only created if the <emphasis>mailHomeServer</emphasis> attribute is set for the user
		  (in the UMC under <guimenu>Advanced settings -> Mail home server </guimenu>).
		</para>

		<para>
		  If the <envar>mail/cyrus/mailbox/delete</envar> &ucsUCRV; has been activated on the mail
		  server and the attribute is removed from the user object, the mailbox is deleted.
		</para>
	  </section>


	  <section id="relnotes:removed">
	  	<title>Removed/no longer supported components</title>
	  	<para>
		  Some components have been removed and are no longer provided with UCS 3.2:

	  	  <itemizedlist>
	  		<listitem><para>
			  The UMC module <guimenu>VNC</guimenu> has been removed. Xrdp can be
			  installed via the Univention App Center as an alternative for graphic remote logins to
			  UCS servers.
			</para></listitem>

			<listitem><para>
			  The <emphasis>univention-local-users</emphasis> package (it was only part of the
			  unmaintained repository section) has been removed.
			</para></listitem>

			<listitem><para>
			  The installer for the Flash plugin has been removed.
			</para></listitem>
	  	  </itemizedlist>

	  	</para>
	  </section>

	  <section id="relnotes:erratas">
		<title>Upcoming errata updates</title>
		<para>
		  The following bugs could not be considered for the final UCS 3.2 release. They will be
		  fixed in errata updates in a timely manner. If necessary, the update should be postponed
		  until the updates are available.

		  <!-- <itemizedlist> -->
		  <!-- 	<listitem><para> -->
		  <!-- 	  Vertrauensstellungen mit Samba 3, in denen Samba einer Windows-Domäne vertraut, -->
		  <!-- 	  funktionieren nicht (die Namensauflösung über Winbind scheitert) (<ulink url="&ucsbug;33303">Bug 33303</ulink>). -->
		  <!-- 	</para></listitem> -->

		  <!-- 	<listitem><para> -->
		  <!-- 	  Der Univention S4 Connector (nötig für den Betrieb von Samba 4) startet in einer -->
		  <!-- 	  reinen IPv6-Umgebung nicht. Als Workaround kann ein virtuelles IPv4-Interface -->
		  <!-- 	  konfiguriert werden (<ulink url="&ucsbug;33250">Bug 33250</ulink>). -->
		  <!-- 	</para></listitem> -->

		  <!-- 	<listitem><para> -->
		  <!-- 	  Windows-Druckertreiber können auf dem Samba-Server bereitgestellt werden -->
		  <!-- 	  (Point'n'Print). Die Bereitstellung der Treiber funktioniert für Windows 8-Clients -->
		  <!-- 	  aktuell noch nicht (<ulink url="&ucsbug;33197">Bug 33197</ulink>). -->
		  <!-- 	</para></listitem> -->
		  <!-- </itemizedlist> -->
		</para>
	  </section>


	</chapter>

    <chapter>
	  <title>Postprocessing of the update</title>

		<para>
		  Following the update, new or updated join scripts need to be executed. This can be done in
		  two ways: Either using the UMC module  <guimenu>Domain join</guimenu> or by running the
		  command <command>univention-run-join-scripts</command> as the user
		  <emphasis>root</emphasis>.
		</para>

		<para>
		  Subsequently the UCS system should be restarted.
		</para>

	  <section id="relnotes:grub2">
		<title>Migration to GRUB 2</title>
		<para>
		  Starting with UCS 3.0, in a new installation, the Univention Installer writes GRUB 2 in
		  the boot sector directly.
		</para>

		<para>
		  In an updated system, GRUB 1 remains installed in the master boot record (MBR). Grub 2
		  sets up a "Chainload into GRUB" entry, which then loads the actual GRUB 2.
		</para>

		<para>
		  Documentation explaining how to write GRUB 2 directly in the MBR on updated systems is
		  provided in the Univention Support Database
		  (<ulink url="http://sdb.univention.de/1218"/>).
		</para>
	  </section>

	  <section id="relnotes:postgres">
		<title>Migration of PostgreSQL 8.3 to PostgreSQL 8.4</title>
		<para>
		  As of UCS 3.0, PostgreSQL 8.4 is also available in addition to PostgreSQL 8.3. When
		  systems with PostgreSQL 8.3 are updated to UCS 3.0, however, the installed PostgreSQL
		  version is retained.
		</para>

		<para>
		  The update to PostgreSQL 8.4 is described in the SDB article <ulink
		  url="http://sdb.univention.de/1220"/>.
		</para>
	  </section>

	  <section id="relnotes:horde">
		<title>Update/installation of the Horde Groupware Webmail Edition</title>
		<para>
		  As of UCS 3.2, the Horde Groupware Webmail Edition will no longer be available via the
		  <emphasis>univention-horde4</emphasis> package and will be provided instead via the
		  Univention App Center. The update of univention-horde4 to or initial installation of Horde
		  5.1.0 is performed by installing the <emphasis>Horde Groupware Webmail Edition</emphasis>
		  app in the Univention App Center.
		</para>
	  </section>

	  <section id="relnotes:sambaproto">
	  	<title>Updating the supported protocols for Samba file services</title>
	  	<para>
		  In versions before UCS 3.2, Samba used the CIFS protocol to provide file services. In new
		  installations as of UCS 3.2, the successor SMB2 is enabled as standard. Using a client
		  which supports SMB2 (as of Windows Vista, i.e., Windows 7/8 too) improves the performance
		  and scalability.
		</para>

	  	<para>
		  In the case of updates from earlier UCS releases, Samba continues to use CIFS. To enable
		  the use of SMB2 subsequently, the &ucsUCR; variable <envar>samba/max/protocol</envar> must
		  be set to <emphasis>SMB2</emphasis> on all Samba servers and the Samba server(s)
		  restarted.
	  	</para>
	  </section>

	  <section id="repo:verify">
		<title>Operating a local repository server / pre-up/ post-up scripts</title>
		<para>
		  Pre-up and postup scripts are scripts which are run before and after release updates
		  (e.g., for post-processing the update, for example by uninstalling obsolete packages).
		  As of UCS 3.2, these scripts are cryptographically signed to prevent unauthorized modification.
		  During the update and when mirroring the repository these signatures are checked.
		  If they're invalid or missing, the action is aborted.
		</para>

		<para>
		  If a repository server is operated with UCS 3.1-x, it should be updated to UCS 3.2
		  before additional systems can be updated to UCS 3.2-1.
		</para>

		<para>
		  If it is not possible to update the repository server, the signature files must be downloaded manually:
		</para>

<programlisting language="sh">
LOCAL_DIR="/var/lib//univention-repository/mirror"
SERVER="http://updates.software-univention.de"
for release in 3.2-0 3.2-1; do
  for script in preup postup; do
    file="3.2/maintained/$release/all/$script.sh.gpg"
    wget -O "$LOCAL_DIR/$file" "$SERVER/$file"
  done
done
</programlisting>

		<para>
		  Alternatively, it is also possible to disable the signature checks, which can be a security risk.
		  For the repository server this can be done by setting the &ucsUCRV; <envar>repository/mirror/verify</envar> to <emphasis>false</emphasis>.
		  For the update the &ucsUCRV; <envar>repository/online/verify</envar> must be set to <emphasis>false</emphasis> on all systems.
		</para>
	  </section>

"/>. -->
	  <!-- 	</para> -->
	  <!-- </section> -->

	  <!-- <section id="relnotes:startpage"> -->
	  <!-- 	<title>Migration von Anpassungen der UCS-Startseite</title> -->
	  <!-- 	<para> -->
	  <!-- 	  Die UCS-Startseite konnte in früheren UCS-Versionen durch &ucsUCR;-Templates im -->
	  <!-- 	  Verzeichnis <filename>/etc/univention/templates/files/var/www/ucs-overview</filename> -->
	  <!-- 	  erweitert werden. Ab UCS 3.2 wird die Startseite durch &ucsUCR;-Variablen erweitert  -->
	  <!-- 	  (<envar>ucs/web/overview/entries/*</envar>, weitere Informationen finden sich in den -->
	  <!-- 	  UCR-Variablenbeschreibungen). Eventuell bestehende Erweiterungen müssen daher manuell -->
	  <!-- 	  migriert werden. -->
	  <!-- 	</para> -->
	  <!-- </section> -->

	</chapter>


    <chapter>
	  <title>Further notes on selected packages</title>

	  <section id="relnotes:usage">
		<title>Collection of usage statistics when using the free-for-personal-use version</title>
		<para>
		  Anonymous usage statistics on the use of the &ucsUMC; are collected when using the
		  <emphasis>free for personal use</emphasis> version of UCS (which is generally used for
		  evaluating UCS). The modules opened are logged in an instance of the web traffic analysis
		  tool Piwik. This makes it possible for Univention to tailor the development of the
		  &ucsUMC; better to customer needs and carry out usability improvements.
		</para>

		<para>
		  This logging is only performed when the free-for-personal-use license is used. The license
		  status can be verified by clicking on the cog symbol in the top righthand corner of the
		  &ucsUMC; and selecting <guimenu>License information</guimenu>. If <emphasis>Free for personal use
		  edition</emphasis> is listed under <guimenu>LDAP base</guimenu>, this version is in
		  use. When a regular UCS license is used, no usage statistics are collected.
		</para>

		<para>
		  Indendepent of the licence used, the statistics generation can be deactivated by setting
		  the &ucsUCR; variable <envar>umc/web/piwik</envar> to <emphasis>false</emphasis>.
		</para>
	  </section>

	  <section id="relnotes:uefi">
		<title>UEFI installation DVD</title>
		<para>
		  Starting with UCS 3.1, in addition to the standard installation DVD there is also a medium
		  with support for the Unified Extensible Firmware Interface standard (UEFI) available for
		  the amd64 architecture.
		</para>

		<para>
		  It can be used instead of the standard DVD on systems which only support a UEFI boot.
		</para>
	  </section>

	  <section id="relnotes:secbrowsers">
		<title>Scope of security support for Webkit, Konqueror und QtWebKit</title>
		<para>
		  Webkit, Konqueror and QtWebkit are shipped in the maintained branch of the UCS repository,
		  but not covered with security support. Webkit is primarily used for displaying HTML help
		  pages etc. Firefox should be used as the web browser.
		</para>
	  </section>

	  <section id="relnotes:browsers">
		<title>Recommeded browsers for the access to the Univention Management Console</title>

		<para>
		  &ucsUMC; uses numerous Javascript and CSS functions to display the web interface. Cookies
		  need to be permitted in the browser. The following browsers are recommended:
		</para>

		  <itemizedlist>
			<listitem>
			  <para>Chrome as of version 14</para>
			</listitem>

			<listitem>
			  <para>Firefox as of version 10</para>
			</listitem>

			<listitem>
			  <para>Internet Explorer as of version 9</para>
			</listitem>

			<listitem>
			  <para>Safari (on the iPad 2)</para>
			</listitem>
		  </itemizedlist>

		<para>
		  Users with older browsers may experience display or performance problems.
		</para>
	  </section>

	  <section id="relnotes:s4limits">
		<title>Restrictions in Samba 4 operation</title>
		<para>
		  The versions of Samba 4 currently published by the Samba project are undergoing more
		  intensive changes in their further development than Samba 3. For this reason, some
		  functions are not yet completely available:
		</para>

		  <itemizedlist>
			<listitem>
			  <para>
				Microsoft Windows domain controllers cannot be joined in a Samba 4 domain
				currently.
			  </para>
			</listitem>

			<listitem>
			  <para>
				Selective replication is not possible with Samba 4 as this is not supported by
				Active Directory in principle (in UCS@school selective replication is implemented
				through the listener/notifier replication mechanism).
			  </para>
			</listitem>

			<listitem>
			  <para>
				Samba 4 does not currently support forest domains.
			  </para>
			</listitem>

			<listitem>
			  <para>
				Samba 4 does not currently support trust relationships.
			  </para>
			</listitem>
		  </itemizedlist>

		<para>
		  Further information can be found in Chapter 8 of the UCS manual <citation>UCS-Handbuch</citation>.
		</para>
	  </section>

	  <section id="relnotes:virtualbox">
		<title>Installation in VirtualBox</title>
		<para>
		  During the installation of UCS in the virtualization solution VirtualBox, a VirtualBox bug may appear
		  which has been corrected in version 4.2: if UCS has been successfully installed and the
		  DVD is still in the disk drive, the installation DVD offers the option <guimenu>Boot from
		  first harddisk partition</guimenu>. If you select this option, VirtualBox freezes.
		</para>

		<para>
		  For Linux distributions which still use Virtualbox 4.0 or 4.1, either the installation DVD
		  can be taken out of the drive settings of the VirtualBox VM or F12 pressed when starting
		  the virtual instance and the hard drive selected as a boot partition as a workaround
		  before starting the UCS VM. UCS will then start successfully.
		</para>
	  </section>

	  <section id="relnotes:xenserver">
		<title>Installation in Citrix XenServer</title>
		<para>
		  When UCS is installed in the virtualization solution Citrix XenServer 6.0 - 6.2, the Grub
		  menu of the Univention installer is not shown with the Cirrus graphics card emulated as
		  standard. The Univention Installer can be started directly by pressing the ENTER key;
		  alternatively, the installation starts automatically after sixty seconds. The Univention
		  Installer which then starts is displayed as normal.
		</para>

		<para>
		  To display Grub correctly, the graphics card emulated by XenServer must be
		  reconfigured. This is done by logging on to the XenServer system as the
		  <emphasis>root</emphasis> user. Firstly, the <command>xe vm-list</command> command is used to
		  determine the UUID of the virtual machine. The following command is then used to
		  reconfigure the emulated graphics card to VGA:

<programlisting language="sh">
xe vm-param-set uuid=UUIDVM platform:vga=std
</programlisting>
		</para>
	  </section>

	  <section id="relnotes:s3tos4">
		<title>Migration of a Samba 3 environment to Samba 4</title>
		<para>
		  There are two basic procedures for migrating Samba 3 to Samba 4:
		</para>

		<itemizedlist>
		<listitem>
		  <para>
			Setup of a parallel Samba 4 domain. Both domains use different NetBIOS names and
			SIDs. The clients then join the Samba 4 step by step.
		  </para>
		</listitem>

		<listitem>
		  <para>
			Migration of all systems within one maintenance window.
		  </para>
		</listitem>
		</itemizedlist>

		<para>
		  Both procedures are documented in detail in the Univention Wiki:
		  <ulink url="http://wiki.univention.de/index.php?title=Migration_from_Samba_3_to_Samba_4"/>.
		</para>
	  </section>

	  <section id="relnotes:xenhopt">
		<title>Xen</title>
		<para>
		  If the Xen hypervisor is used and the memory limit for the Dom0 has been configured using
		  the &ucsUCR;-Variable <envar>grub/xenhopt</envar>, the value should be updated to include
		  the <emphasis>,max:</emphasis> part as well. See the
		  <ulink url="http://wiki.univention.de/index.php?title=UVMM_Quickstart-3.1/en#Configuring_the_Dom0"/>
		  for details.
		</para>
	  </section>
	</chapter>

    <chapter>
	  <title>Changelog</title>
	  <para>
		Listed are the changes since UCS 3.1-1:
	  </para>

	  &changelog;

	</chapter>

    <?dbhtml-include href="../stylesheets/piwiki.html"?>
</book>
