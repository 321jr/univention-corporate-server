<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE chapter  PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
	"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
	<!ENTITY % extensions SYSTEM "../stylesheets/macros.ent" >
	%extensions;
	<!ENTITY % entities SYSTEM "../stylesheets/macros-en.ent" >
	%entities;
]>
<chapter id="relnotes:changelog" lang="en">
	<title>Changelog</title>
	<section id="changelog:general">
		<title>General</title>
		<itemizedlist>
			<listitem><simpara>
				The codename for UCS 4.1 has been set to <wordasword>Vahr</wordasword> (<u:bug>39223</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
				The package <package>univention-container-role-common</package> has been added. It
				is used to strip down the base installed packages in a Docker image
				(<u:bug>38283</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
				The errata level is reset during the upgrade to UCS 4.1 (<u:bug>39312</u:bug>).
			</simpara></listitem>
		</itemizedlist>
	</section>

	<section id="changelog:installer">
		<title>Univention Installer</title>
		<itemizedlist>
			<listitem><simpara>
			</simpara></listitem>
		</itemizedlist>
	</section>


	<section id="changelog:basic">
		<title>Basic system services</title>

		<section id="changelog:basic:kernel">
			<title>Linux kernel and firmware packages</title>
			<itemizedlist>
				<listitem><simpara>
					The Linux kernel has been updated to 4.1.6 (<u:bug>38873</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:basis:ucr">
			<title>Univention Configuration Registry</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>

			<section id="changelog:basis:ucr:template">
				<title>Changes to templates and modules</title>
				<itemizedlist>
					<listitem><simpara>
					</simpara></listitem>
				</itemizedlist>
			</section>
		</section>

		<section id="changelog:basis:boot">
			<title>Boot Loader</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:basis:other">
			<title>Other system services</title>
			<itemizedlist>
				<listitem><simpara>
					The network registration is now skipped in the init script
					<filename>univention-network-common</filename> if UCS is running in a Docker
					container because the network registration for this mode is implemented in
					the init script <filename>univention-docker-container-mode</filename>
					(<u:bug>38365</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
						<filename>univention-firewall</filename> now creates port forwarding
						rules for services in Docker containers (<u:bug>38307</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:domain">
		<title>Domain services</title>

		<section id="changelog:domain:openldap">
			<title>OpenLDAP</title>
			<itemizedlist>
				<listitem><simpara>
					OpenLDAP has been updated to version 2.4.42 (<u:bug>38876</u:bug>).
				</simpara></listitem>
			</itemizedlist>

			<section id="changelog:domain:openldap:acl">
				<title>LDAP ACL changes</title>
				<itemizedlist>
					<listitem><simpara>
						The permissions for GSSAPI SASL authentication have been fixed (<u:bug>29482</u:bug>).
					</simpara></listitem>
				</itemizedlist>
			</section>

			<section id="changelog:domain:openldap:schema">
				<title>LDAP schema changes</title>
				<itemizedlist>
					<listitem><simpara>
					</simpara></listitem>
				</itemizedlist>
			</section>

			<section id="changelog:domain:openldap:replication">
				<title>Listener/Notifier domain replication</title>
				<itemizedlist>
					<listitem><simpara>
					</simpara></listitem>
				</itemizedlist>
			</section>

			<section id="changelog:domain:dnsserver">
				<title>DNS server</title>
				<itemizedlist>
					<listitem><simpara>
					</simpara></listitem>
				</itemizedlist>
			</section>
		</section>
	</section>

	<section id="changelog:umc">
		<title>Univention Management Console</title>

		<section id="changelog:umc:web">
			<title>Univention Management Console web interface</title>
			<itemizedlist>
				<listitem><simpara>
					Support for logging in with the primary email address at UMC has been added (<u:bug>38528</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Unmovable objects are no longer shown as movable (<u:bug>20439</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					All UMC cookies are now restricted to the path <uri>/univention-management-console/</uri>.
					The entry point <uri>/umcp/</uri> has therefore been moved to <uri>/univention-management-console/</uri> (<u:bug>38820</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					A service entry for Univention Management Console has been added and the
					<package>univention-management-console-web-server</package> join script adds
					this service automatically to the LDAP host entry (<u:bug>39553</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:server">
			<title>Univention Management Console server</title>
			<itemizedlist>
				<listitem><simpara>
					The exception <classname>SystemExit</classname> is now caught by the UMC server and not shown as a traceback to the user (<u:bug>39031</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					A memory leak in the UMC webserver has been fixed which could occur when a SSL communication between UMC webserver and UMC server was not possible (<u:bug>38402</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:appcenter">
			<title>Univention App Center</title>
			<itemizedlist>
				<listitem><simpara>
					The App Center is now able to install docker based apps. These apps are installed in a small container (minimal UCS) within the host system
					(<u:bug>39185</u:bug>, <u:bug>39258</u:bug>, <u:bug>39374</u:bug>, <u:bug>39331</u:bug>, <u:bug>39184</u:bug>, <u:bug>39183</u:bug>, <u:bug>39196</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:udmcli">
			<title>&ucsUDM; UMC modules and command line interface</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:setup">
			<title>Basic settings / Appliance mode</title>
			<itemizedlist>
				<listitem><simpara>
					The <package>System Setup</package> wizard now can have a configurable domain while the hostname itself is fixed. This is needed
					for Univention Apps (<u:bug>38275</u:bug>, <u:bug>38154</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					During the initial System Setup the restart of the webserver is no longer disabled.
					This is needed for Univention Apps (<u:bug>39476</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:user">
			<title>Users module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:reports">
			<title>Univention Directory Reports</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:computers">
			<title>Computers module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:dns">
			<title>DNS module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:license">
			<title>License module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:top">
			<title>Process overview module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:update">
			<title>Software update module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:share">
			<title>Shares module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:policy">
			<title>Policies</title>
			<itemizedlist>
				<listitem><simpara>
					 A traceback has been fixed when adding a objects without having policies referenced (<u:bug>37667</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:printer">
			<title>Printers module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:mail">
			<title>Mail</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:quota">
			<title>Filesystem quota module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:ucr">
			<title>Univention Configuration Registry module</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:ldap">
			<title>LDAP directory browser</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:other">
			<title>Other modules</title>
			<itemizedlist>
				<listitem><simpara>
					Various modules are now able to handle <package>python-psutil</package> API changes (<u:bug>39322</u:bug>, <u:bug>39323</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:umc:development">
			<title>Development of modules for &ucsUMC;</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:deployment">
		<title>Software deployment</title>
		<itemizedlist>
			<listitem><simpara>
					The size of the UCS installation DVD has been reduced by removing all packages not strictly required for installation from the DVD.
					All maintained packages are still available online or through the update DVD.
			</simpara></listitem>
			<listitem><simpara>
				The updater scripts <filename>preup.sh</filename> and <filename>postup.sh</filename>
				have been adapted to the needs of UCS 4.1 (<u:bug>39271</u:bug>).
			</simpara></listitem>
		</itemizedlist>

		<section id="changelog:deployment:pkgdb">
			<title>Software monitor</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:deployment:cli">
			<title>Software deployment command line tools</title>
			<itemizedlist>
				<listitem><simpara>
						The mount point for CD-ROM images in <command>univention-updater</command> and <command>univention-repository-update</command> have been fixed (<u:bug>36721</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:lib">
		<title>Univention base libraries</title>
		<itemizedlist>
			<listitem><simpara>
				The function <function>is_ucr_true</function> has been added to the package <package>shell-univention-lib</package> (<u:bug>27701</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
					The package <package>OpenSSL</package> was updates to version <literal>1.0.2d</literal> (<u:bug>39500</u:bug>).
			</simpara></listitem>
		</itemizedlist>
	</section>


	<section id="changelog:service">
		<title>System services</title>

		<section id="changelog:service:saml">
			<title>SAML</title>
			<itemizedlist>
				<listitem><simpara>
					The SAML identity provider app has been integrated into UCS (<u:bug>38881</u:bug>, <u:bug>39468</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The package <package>univention-saml</package> is installed on DC Master and
					DC Backup systems automatically during the UCS 4.1 upgrade
					(<u:bug>39313</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Single sign on via SAML 2.0 is now possible with Univention Management Console
					(<u:bug>39171</u:bug>), (<u:bug>39178</u:bug>), (<u:bug>31943</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					A download link for the public certificate of the identity provider has been added to the module (<u:bug>32786</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Every SAML identity provider registers its default IP address via DNS at the
					host record <property>ucs-sso</property>. The name can be changed through the
					&ucsUCRV; <envar>ucs/server/sso/fqdn</envar> (<u:bug>39386</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The <application>SimpleSAMLphp</application> certificate is now created in the joinscript instead of the postinst of the package (<u:bug>39255</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The <application>SimpleSAMLphp</application> files <filename>authsources.php</filename> and <filename>saml20-idp-hosted.php</filename> have been changed to a UCR multifile template (<u:bug>39250</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					<application>SimpleSAMLphp</application> has been updated to version 1.13.2-1 (<u:bug>38982</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					<property>AssertionConsumerService</property> is now a multi-value field (<u:bug>39015</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The ACL evaluation of <application>SimpleSAMLphp</application> has been fixed (<u:bug>38935</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Renaming of a service provider is now prevented as the user references weren't updated when doing so (<u:bug>38934</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Transmitting LDAP attributes from the identity provider is now possible and does not cause exceptions in <application>SimpleSAMLphp</application> anymore (<u:bug>38927</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The <property>entityID</property> of the identity provider is now configurable via the &ucsUCRV; <envar>saml/idp/entityID</envar> (<u:bug>33912</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The SAML identity provider now uses a dedicated LDAP user to access the LDAP and a separate user is used to access <acronym>SSO</acronym> specific web-content by <application>apache2</application> (<u:bug>38947</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The App Center module has been adapted to work with single sign on (<u:bug>39226</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The UMC server and LDAP server allow authentication with a SAML assertion via the packages <application>pam-saml</application> and <application>cy2-saml</application> (<u:bug>39315</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					<package>PHP</package> syntax is now correctly escaped and validated when writing the <package>simplesamlphp</package> service provider configuration (<u:bug>38933</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The SAML join script has been moved from <package>univention-saml-schema</package> to
					<package>univention-saml</package> (<u:bug>39472</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>
		<section id="changelog:service:mail">
			<title>Mail services</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:virus">
			<title>Spam/virus detection and countermeasures</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:print">
			<title>Printing services</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:nagios">
			<title>Nagios</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:ssl">
			<title>SSL</title>
			<itemizedlist>
				<listitem><simpara>
					<package>univention-ssl</package> can now create certificates for FQDNs longer than 64 characters.
					The OpenSSL extension <property>Subject Alternative Name</property> is used in such a case (<u:bug>38859</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:proxy">
			<title>Proxy services</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:systeminfo">
			<title>Univention System Info</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:apache">
			<title>Apache</title>
			<itemizedlist>
				<listitem><simpara>
					<package>univention-apache</package> now ships expandable <property>VHost</property> configuration files (<u:bug>38807</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:pam">
			<title>PAM / Local group cache</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:service:other">
			<title>Other services</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:virt">
		<title>Virtualization</title>

		<section id="changelog:virt:uvmm">
			<title>Univention Virtual Machine Manager (UVMM)</title>
			<itemizedlist>
				<listitem><simpara>
					UVMM profiles for Windows 10 have been added (<u:bug>39335</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:virt:operation">
			<title>Operate UCS as virtual machine</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:container">
		<title>Container Technologies</title>
			<itemizedlist>
				<listitem><simpara>
					The package <package>docker.io</package> has been updated to
					<wordasword>1.6</wordasword> (<u:bug>39350</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					OverlayFS has been configured as the Docker storage driver
					(<u:bug>39412</u:bug>, <u:bug>39418</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The packages <package>univention-docker-container-mode</package> and
					<package>univention-appliance-docker-container</package> have been added.
					These packages help to run UCS in a Docker container
					(<u:bug>39331</u:bug>, <u:bug>38260</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The function <function>ucs_registerLDAPExtension</function>
					from package <package>shell-univention-lib</package> now supports
					the options <option>packagename</option> and
					<option>packageversion</option>
					(<u:bug>38205</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					When joining a UCS domain, Docker containers do not register their IP
					and MAC addresses in the computer object (<u:bug>38437</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					UCR can now modify files on a bind-mounted filesystem in a Docker
					container (<u:bug>38011</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The Heimdal Kerberos installation does not fail anymore in a Docker
					container (<u:bug>38295</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					No keyboard or console font setup is done inside a Docker container
					(<u:bug>38763</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					A docker repository is now hosted on <uri>docker.software-univention.de</uri>
					(<u:bug>39188</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					A <filename>docker</filename> init script has been added
					which properly stops and restarts running containers
					(<u:bug>39474</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Docker images running UCS in container mode now update their
					IP addresses in LDAP if one is already registered there.
					This is useful because Docker dynamically assigns IP
					addresses during container restarts.
					(<u:bug>38334</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					Docker images running UCS in container mode now try to
					register the IP also with a <systemitem class="service">consul</systemitem> and
					<systemitem class="service">etcd</systemitem> service running the Docker host.
					(<u:bug>38331</u:bug>).
				</simpara></listitem>
			</itemizedlist>
	</section>


	<section id="changelog:win">
		<title>Services for Windows</title>
		<section id="changelog:win:samba">
			<title>Samba</title>
			<itemizedlist>
				<listitem><simpara>
					The default domain and forest function level for new installations is now <emphasis>2008 R2</emphasis> (<u:bug>38800</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The &ucsUCRV; <envar>samba/register/exclude/interfaces</envar> has been added.
					The IP addresses of theses network interfaces are not registered automatically in DNS.
					By default the variable is set to <option>docker0</option>
					(<u:bug>39466</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The &ucsUCRV; <envar>samba/max/protocol</envar> doesn't get set any longer for new
					installations. Additionally, if it was set to the default "SMB2" it will get unset
					as well during updates. The purpose of this change is to give customers the
					highest protocol level considered stable by the Samba team. Currently this
					is <option>SMB3_11</option>.
					(<u:bug>32939</u:bug>).
				</simpara></listitem>
				<listitem><simpara>
					The <filename>IPC$ share</filename> is not explicitly configured any longer
					in the default configuration where <envar>samba4/service/smb</envar> is <option>s3fs</option>.
					This change avoids a lot of unnecessary warning messages from samba
					(<u:bug>29227</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:win:takeover">
			<title>Univention AD Takeover</title>
			<itemizedlist>
				<listitem><simpara>
					The FSMO roles <wordasword>domaindnsmaster</wordasword> and
					<wordasword>forestdnsmaster</wordasword> are now seized during
					the takeover (<u:bug>39222</u:bug>).
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:win:s4c">
			<title>Univention S4 Connector</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>

		<section id="changelog:win:adc">
			<title>Univention Active Directory Connection</title>
			<itemizedlist>
				<listitem><simpara>
				</simpara></listitem>
			</itemizedlist>
		</section>
	</section>


	<section id="changelog:other">
		<title>Other changes</title>
		<itemizedlist>
			<listitem><simpara>
				Asterisk has been updated to 11.13.1. It provides many bugfixes and fixes
				several vulnerabilities (<u:bug>37738</u:bug>, <u:bug>39285</u:bug>)
			</simpara></listitem>
			<listitem><simpara>
				<package>univention-join</package> now correctly checks for the existence of <command>nscd</command>. This is needed in a minimal environment (<u:bug>38662</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
				<command>nscd</command> terminates its children when stopping (<u:bug>38135</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
				The packages for the default <emphasis>settings/packages</emphasis> &ucsUDM; objects
				have been updated (<u:bug>32443</u:bug>).
			</simpara></listitem>
			<listitem><simpara>
				Several package dependencies in Docker related base packages have been changed (<u:bug>39410</u:bug>).
			</simpara></listitem>
		</itemizedlist>
	</section>
</chapter>
<!-- vim: set ts=4 sw=4 noet: -->
