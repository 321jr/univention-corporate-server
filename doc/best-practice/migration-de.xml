<chapter>
  <title>Migration einer Active Directory-Domäne nach &ucsUCS;</title>
  <section>
	<title>Einleitung</title>
	<para>
	  Diese Dokumentation beschreibt das Vorgehen bei der Migration einer Microsoft Active
	  Directory-Domäne auf Basis von Windows Server 2003/2008/2012 auf &ucsUCS;.
	</para>

	<para>
	  Es werden zwei Szenarien unterschieden:

	  <itemizedlist>
		<listitem><simpara>
		  Migration eine Umgebung mit einem Domänencontroller und einer AD-Site (z.B. Microsoft
		  Small Business Server)
		</simpara></listitem>

		<listitem><simpara>
		  Migration einer verteilten Active Directory-Umgebung mit mehreren Domänencontrollern und
		  verteilten Standorten
		</simpara></listitem>
	  </itemizedlist>
	</para>

	<para>
	  Neben der Migration der Kern-Domänendienste (also Anmeldung, Datei-/Druckdienste) besteht auch
	  die Möglichkeit verschiedene Dienste einer AD-Umgebung zu migrieren: Das Univention App Center
	  stellt verschiedene Applikationen bereit, die z.B. einen Exchange-Groupware-Server oder einen
	  Sharepoint-Dienst ablösen können. Dies wird in TODOREF beschrieben.
	</para>
  </section>

  <section>
	<title>Migration einer AD-Domäne mit einem Domänencontroller (Single-Server-Umgebung)</title>

	<section>
	  <title>Einleitung</title>

	  <para>
		Jede UCS-Umgebung besteht aus min. einem &ucsMaster; und einer beliebigen Anzahl weiterer
		Server. So besteht beispielsweise die Möglichkeit einen Dienst wie Groupware auf einen
		separaten Server zu verteilen oder an verschiedenen Standorten einen lokalen Server zu
		betreiben.
	  </para>

	  <para>
		Diese Variante der Migrations-Dokumentation beschreibt die Migration auf einen einzelnen
		UCS-Server. Wenn die Umgebung später wächst oder aus anderen Gründen verteilt werden soll ist eine
		Aufteilung von Diensten jederzeit nachträglich möglich.
	  </para>
	</section>

	<section id="bestpractice:migration:single:installucs">
	  <title>Installation des UCS-Systems</title>
	  <para>
		Für die Migration wird ein separater Server mit UCS installiert. Die Installation des
		Systems kann anhand des UCS-Quickstart Guides erfolgen TODOREF. Bei der Installation müssen
		die folgenden Einstellungen gewählt werden:

		<itemizedlist>
		  <listitem><simpara>
			<emphasis>Sprache</emphasis>,<emphasis>Zeitzone</emphasis>, <emphasis>Tastaturbelegung</emphasis>: Beliebig
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>Systemrolle</emphasis>: Domain Controller Master
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>Vollständiger Rechnername</emphasis>: Dieser Wert besteht aus dem Rechnernamen und dem
			Domänennamen. In <emphasis>server1.company.example</emphasis> ist
			<emphasis>server1</emphasis> der Rechnernamen und <emphasis>company.example</emphasis>
			der Domänenname. Der Rechnername kann beliebige gewählt werden, darf aber in der
			aktuellen AD-Domäne noch nicht in Verwendung sein. Als Domänenname muss der
			AD-Domänenname verwendet werden (er wird z.B. in der Windows-Systemsteuerung unter
			<guimenu>System und Sicherheits -> System</guimenu> im Feld <guimenu>Domäne</guimenu>
			angezeigt.
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>LDAP-Basis</emphasis> und <emphasis>Windows-Domäne</emphasis> werden auf Basis
			des vollständigen Rechnernamens vorschlagen, hier sollte der vorgeschlagene Wert
			übernommen werden.
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>Root-Passwort</emphasis>: Das hier konfigurierte Passwort ist auch das
			initiale Passwort für das Administrator-Konto auf dem UCS-Server. Hier sollte dasselbe
			Administrator-Passwort wie in der AD-Domäne verwendet werden.
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>Partitionierung</emphasis>: Beliebig, es wird empfohlen die automatische
			Partitionierung zu verwenden.
		  </simpara></listitem>

		  <listitem><simpara>
			<emphasis>Netzwerk-Konfiguration</emphasis>: Es muss eine IPv4-Adresse im selben Subnetz wie der zu
		  übernehmende AD-Domänencontroller verwendet werden.
		  </simpara></listitem>

		  <listitem><simpara>
			Die Softwareauswahl kann komplett leergelassen werden. Alle benötigten Applikationen
			werden später aus dem Univention App Center installiert.
		  </simpara></listitem>
		</itemizedlist>
	  </para>

	  <para>
		Wenn die Installation abgeschlossen ist, muss das UCS-System durch einen Tastendruck neu
		gestartet werden. Der UCS-Server ist nun installiert, enthält aber noch nicht die
		Benutzerdaten der AD-Domäne. Diese werden in einem späteren Schritt migriert.
	  </para>

	</section>

	<section id="bestpractice:migration:single:services">
	  <title>Installation des UCS-Systems</title>
	  <para>
		Es muss nun geprüft werden, welche Dienste durch den AD-Server aktuell bereitgestellt
		werden:
	  </para>

	  <para>
		Der Domänencontroller-Dienst wird durch UCS in AD-kompatibler Weise bereitgestellt: Ein
		Windows-Client, der in die AD-Domäne gejoint wurde, ist nach der Migration auch in der
		UCS-Domäne verfügbar, d.h. es ist kein erneuter Domänenbeitritt nötig. Alle
		Benutzerkonten und Gruppen werden ebenfalls migriert. Nach Durchführung der Migration ist
		der AD-Server nicht mehr verfügbar, d.h. alle weiteren vom AD-Server bereitgestellten
		Dienste müssen migriert werden. Hierfür gibt es prinzipiell zwei verschiedene Möglichkeiten:

		<itemizedlist>
		  <listitem><simpara>
			Migration der Dienste auf den UCS-Server. Dies wird für verschiedene Dienste in TODOREF
			beschrieben.
		  </simpara></listitem>

		  <listitem><simpara>
			Installation eines Member-Servers in der AD-Domäne und Migration der Dienste auf diesen
			Server. Der Memberserver später im Rahmen der Übernahme der AD-Domäne automatisch in die
			UCS-Domäne übernommen.
		  </simpara></listitem>
		</itemizedlist>
	  </para>

	  <para>
		Werden neben dem Anmeldedienst alle weiteren Dienste auf einen Memberserver migriert, ist
		kein langes Wartungsfenster für die Migration von AD auf UCS nötig; die Umstellung sollte in
		unter einer Stunde erledigt sein. Wenn während der Umstellung auch Dienste migriert werden
		sollen, kann sich dieses Fenster deutlich ausweiten, die Entzerrung der Migration durch
		Migration der Dienste auf einen Memberserve ist daher empfehlenswert.
	  </para>
	</section>

	<section id="bestpractice:migration:single:services:migrate">
	  <title>Migration von Diensten auf einem Windows-Server</title>

	  <section id="bestpractice:migration:single:services:migrate:fileshare">
		<title>Migration von Datei-Freigaben</title>

		<para>
		  Ein UCS-Domänencontroller bietet standardmässig auch Dateidienste an. Alternativ kann auch
		  ein UCS-Memberserver installiert werden, der Dateidienste bereitstellt.

		  TODO: Migration
		</para>

	  </section>

	  <section id="bestpractice:migration:single:services:migrate:printshare">
		<title>Migration von Drucker-Freigaben</title>

		<para>
		  Jeder UCS-Server kann Druckdienste anbieten. Dazu muss im &ucsUMC;-Modul
		  <guimenu>Univention App Center</guimenu> in der Sektion <guimenu>UCS-Komponenten</guimenu>
		  die Applikation <emphasis>Druckserver (CUPS)</emphasis> ausgewählt werden.

		  TODO: Migration
		</para>

	  </section>

	  <section id="bestpractice:migration:single:services:migrate:exchange">
		<title>Migration von Microsoft Exchange</title>

		<para>
		  Wenn auf dem AD-Server Microsoft Exchange betrieben wird, besteht die Möglichkeit auf eine
		  Groupware aus dem Univention App Center zu migrieren. Diese sind im Univention App Center
		  in der Sektion <emphasis>Collaboration</emphasis> zu finden. Diese Groupware-Lösungen
		  werden von externen Anbietern bereitgestellt und mit Support versorgt.
		</para>
	  </section>
	</section>

  </section>

</chapter>
