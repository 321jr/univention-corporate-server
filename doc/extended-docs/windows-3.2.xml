<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
          "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [

  <!ENTITY % entities SYSTEM "../stylesheets/macros-en.ent" >

  %entities;
]>
<book lang="en" id="windows-3.2">
    <bookinfo>
      <title>Univention Corporate Server</title>
      <subtitle>Extended Windows integration documentation</subtitle>

        <revhistory>
            <revision>
                <revnumber>3.2-0</revnumber>
                <date>1 Dec 2013</date>
            </revision>
        </revhistory>
    </bookinfo>

    <chapter>
        <title>Advanced Samba documentation</title>
        <section>
            <title>Operating Samba 4 as a read-only domain controller</title>
			<para>
			  Active Directory offers an operating mode called <emphasis>read-only domain
			  controller</emphasis> (RODC) with the following properties:

			  <itemizedlist>
				<listitem><para>
				  The data are only stored in read-only format; all write changes must be
				  performed on another domain controller.
				</para></listitem>

				<listitem><para>
				  Consequently, replication is only performed in one direction.
				</para></listitem>
			  </itemizedlist>

			  A comprehensive description can be found in the Microsoft TechNet Library <biblioref linkend="technet-rodc"/>.
			</para>

			<para>
			  A Samba 4 domain controller can be operated in RODC mode (on a &ucsSlave; for
			  example). Prior to the installation of <emphasis>univention-samba4</emphasis>, the
			  &ucsUCRV; <envar>samba4/role</envar> must be set to <emphasis>RODC</emphasis>:
			</para>
<programlisting language="sh">
ucr set samba4/role=RODC
univention-install univention-samba4
univention-run-join-scripts
</programlisting>

        </section>
    </chapter>

    <chapter>
	  <title>Advanced Active Directory connector documentation</title>
	  <section>
		<title>Synchronisation of several Active Directory domains with one UCS directory service</title>
		<para>
		  It is possible to synchronise several separate Active Directory domains with one UCS
		  directory service (e.g. to synchronise with an AD forest). One OU
		  (organisational unit) can be defined in LDAP for each AD domain, under which the objects
		  of the respective domains are synchronised. The configuration of further connector
		  instances is not covered by the UMC module.
		</para>

		<para>
		  Several connector instances are started parallel to each other. Each connector instance is
		  operated with a self-contained configuration base. The
		  <command>prepare-new-instance</command> script is used to create a new instance, e.g.:

<programlisting language="sh">
/usr/share/univention-ad-connector/scripts/prepare-new-instance -a create -c connector2
</programlisting>
		</para>

		<para>
		  This script creates an additional init script for the second connector instance
		  (<filename>/etc/init.d/univention-ad-connector2</filename>), a configuration directory
		  <filename>/etc/univention/connector2</filename> with a copy of the mapping settings of
		  the main connector instance (this can be adapted if necessary) and an array of internal
		  runtime directories.
		</para>

		<para>
		  The additional connector instances are registered in the &ucsUCRV;
		  <envar>connector/listener/additionalbasenames</envar>.
		</para>

		<para>
		  If a UCS synchronisation is performed towards Active Directory, the replication of the
		  listener module must be restarted after a further connector instance is created. To this
		  end, the following command must be run:

<programlisting language="sh">
univention-directory-listener-ctrl resync ad-connector
</programlisting>
		</para>

		<para>
		  The command line tools which belong to the AD Connector such as
		  <command>univention-adsearch</command> support selecting the connector instance with the
		  parameter <emphasis>-c</emphasis>.
		</para>
	  </section>
	</chapter>


	<bibliography>
		<bibliomixed id="technet-rodc"/>
	</bibliography>

    <?dbhtml-include href="../stylesheets/piwiki.html"?>
</book>
