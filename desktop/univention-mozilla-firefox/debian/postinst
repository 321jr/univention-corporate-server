#!/bin/sh

#DEBHELPER#

univention-config-registry set firefox/prefs/mailto?kmail
univention-config-registry set firefox/prefs/checkdefaultbrowser?false

eval $(univention-config-registry shell)

if	[ -z "$firefox_prefs_homepage" ] ||
	[ "$firefox_prefs_homepage" = "http://www.univention.de/ucd-welcome-2_0-0.html" ] ||
	[ "$firefox_prefs_homepage" = "http://www.univention.de/ucd-welcome-2_1-0.html" ] ||
	[ "$firefox_prefs_homepage" = "http://www.univention.de/ucd-welcome-2_2-0.html" ] ||
	[ "$firefox_prefs_homepage" = "http://www.univention.de/ucd-welcome-2_3-0.html" ]; then
	univention-config-registry set firefox/prefs/homepage="http://www.univention.de/ucd-welcome-2_4-0.html"
fi

update-alternatives --install /usr/bin/x-www-browser x-www-browser /usr/bin/firefox 101

if [ "$1" = "configure" ] && [ -z "$2" ]; then

	mkdir -p /etc/univention/skel/Downloads

	univention-config-registry set firefox/prefs/printing?kprinter

	univention-config-registry set firefox/prefs/spellchecker/dictionary="en-US"
	if [ -n "$locale_default" ]; then
		lang=$(echo $locale_default | sed -e 's|_.*||')
		if [ "$lang" = "de" ]; then
			univention-config-registry set firefox/prefs/spellchecker/dictionary="de-DE"
		fi
	fi
fi

if [ "$1" = configure -a -n "$2" ] && dpkg --compare-versions "$2" lt 3.0.3-1; then
	# before UCS 2.2 the default language was de-DE
	univention-config-registry set firefox/prefs/spellchecker/dictionary?"de-DE"
fi

if [ "$1" = configure -a -n "$2" ] && dpkg --compare-versions "$2" lt 5.0.2-1; then
	mkdir -p /etc/univention/skel/Downloads
fi

exit 0

