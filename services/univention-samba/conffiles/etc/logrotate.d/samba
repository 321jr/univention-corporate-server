@%@UCRWARNING=# @%@

/var/log/samba/log.smbd {
	#UCRV logrotate/[log.smbd/]rotate: weekly
	#UCRV logrotate/[log.smbd/]missingok: missingok
	#UCRV logrotate/[log.smbd/]rotate/count: rotate 7
@!@
import univention.lib.ucrLogrotate
name = "log.smbd"
settings = univention.lib.ucrLogrotate.getLogrotateConfig(name, configRegistry)
for value in settings.itervalues():
	print "\t%s" % value
@!@
	postrotate
		[ ! -x /usr/bin/smbcontrol ] || /usr/bin/smbcontrol smbd reload-config
	endscript
	#UCRV logrotate/[log.smbd/]compress: compress
	delaycompress
	#UCRV logrotate/[log.smbd/]notifempty: notifempty
}

/var/log/samba/log.nmbd {
	#UCRV logrotate/[log.nmbd/]rotate: weekly
	#UCRV logrotate/[log.nmbd/]missingok: missingok
	#UCRV logrotate/[log.nmbd/]rotate/count: rotate 7
@!@
import univention.lib.ucrLogrotate
name = "log.nmbd"
settings = univention.lib.ucrLogrotate.getLogrotateConfig(name, configRegistry)
for value in settings.itervalues():
	print "\t%s" % value
@!@
	postrotate
		[ ! -x /usr/bin/smbcontrol ] || /usr/bin/smbcontrol nmbd reload-config
	endscript
	#UCRV logrotate/[log.nmbd/]compress: compress
	delaycompress
	#UCRV logrotate/[log.nmbd/]notifempty: notifempty
}

/var/log/samba/log.samba {
	#UCRV logrotate/[log.samba/]rotate: weekly
	#UCRV logrotate/[log.samba/]missingok: missingok
	#UCRV logrotate/[log.samba/]rotate/count: rotate 7
@!@
import univention.lib.ucrLogrotate
name = "log.samba"
settings = univention.lib.ucrLogrotate.getLogrotateConfig(name, configRegistry)
for value in settings.itervalues():
	print "\t%s" % value
@!@
	postrotate
		if [ -d /run/systemd/system ] && command systemctl >/dev/null 2>&1 && systemctl is-active --quiet samba-ad-dc; then
			systemctl kill --kill-who all --signal=SIGHUP samba-ad-dc
		elif [ -f /var/run/samba/samba.pid ]; then
			# This only sends to main pid, See #803924
			kill -HUP `cat /var/run/samba/samba.pid`
		fi
	endscript
	#UCRV logrotate/[log.samba/]compress: compress
	delaycompress
	#UCRV logrotate/[log.samba/]notifempty: notifempty
}
