}

EVENTS {
@!@
if baseConfig.has_key('mail/cyrus/murder/backend/hostname') and baseConfig['mail/cyrus/murder/backend/hostname'] != '':
	backend_hostname = baseConfig['mail/cyrus/murder/backend/hostname']
else:
	backend_hostname = '.'.join([ baseConfig['hostname'], baseConfig['domainname'] ])

# If we run without a Cyrus Murder Master MUPDATE server
# or if we have registered as a 'kolab2' service provider (aka 'backend' or 'spool')
if not (baseConfig.has_key('mail/cyrus/murder/master') and baseConfig['mail/cyrus/murder/master'] != '') \
   or (baseConfig.has_key('mail/cyrus/murder/backends') \
       and backend_hostname in baseConfig['mail/cyrus/murder/backends'].split(' ')):
	print '''
	# --- Periodic care for normal cyrus spool, or Murder backends ---'
	checkpoint	cmd="/usr/sbin/ctl_cyrusdb -c -C /etc/imapd/imapd.conf" period=30

	# this is only necessary if using duplicate delivery suppression
	delprune	cmd="/usr/sbin/ctl_deliver -E 3 -C /etc/imapd/imapd.conf" at=0401

	# this is only necessary if caching TLS sessions
	tlsprune	cmd="/usr/sbin/tls_prune -C /etc/imapd/imapd.conf" at=0401
	# ----------------------------------------------------------------'
'''
