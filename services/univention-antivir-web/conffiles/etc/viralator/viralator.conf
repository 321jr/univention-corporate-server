#VIRALATOR CONFIGURATION FILE

#The configuration uses this syntax:
# directive -> value
# Pay attention that the separator must be allways an arrow

# DEFAULT LANGUAGE
# The default language that will be used in Viralator forms
#Possible values "it", "en" or write your own lang!
default_language -> english.txt

# ANTIVIRUS PROGRAM NAME
# Possible values: INOCULATE, AVP, RAV, ANTIVIR, MCAFEE, SOPHOS, TREND, CLAMAV, BITDEFENDER
# DON'T use spaces, "-", "_" or any other non alphabetic character
#antivirus -> CLAMAV
antivirus -> @%@proxy/antivir/scanner@%@

# VIRUS SCANNER
# The actually virus scanner program
# Some examples bellow:
# INOCULATE => inocucmd
# AVP       => AvpLinux
# RAV       => ravlin8
# ANTIVIR   => antivir
# MCAFEE    => uvscan
# SOPHOS    => sweep
# TREND     => vscan
# CLAMAV    => clamscan
# BITDEFENDER console free edition: bdc
# DON'T use spaces, "-", "_" or any other non alphabetic character
#virusscanner -> clamdscan
@!@
virusscanner=''
scannerpath=''
viruscmd=''
alert=''

if baseConfig.has_key("proxy/antivir/scanner") and baseConfig["proxy/antivir/scanner"]:
	if baseConfig["proxy/antivir/scanner"] == "INOCULATE":
		virusscanner="inocucmd"
		scannerpath="/usr/local/av"
		viruscmd="-FST -VER"
		alert="Total Viruses Found"
	elif baseConfig["proxy/antivir/scanner"] == "AVP":
		virusscanner="kavscanner"
		scannerpath="/usr/bin"
		viruscmd="-i3"
		alert="Known viruses :"
	elif baseConfig["proxy/antivir/scanner"] == "RAV":
		virusscanner="ravlin8"
		scannerpath="/usr/bin"
		viruscmd="-UNZIP"
		alert="Infected:"
	elif baseConfig["proxy/antivir/scanner"] == "ANTIVIR":
		virusscanner="antivir"
		scannerpath="/usr/local/AntiVir"
		viruscmd="-z"
		alert="Infected:"
	elif baseConfig["proxy/antivir/scanner"] == "MCAFEE":
		virusscanner="uvscan"
		scannerpath="/usr/local/uvscan"
		viruscmd="--summary --noexpire --unzip"
		alert="Infected: ....."
	elif baseConfig["proxy/antivir/scanner"] == "SOPHOS":
		virusscanner="sweep"
		scannerpath="/usr/local/bin"
		viruscmd="-archive -di -remove -nc"
		alert="Infected:"
	elif baseConfig["proxy/antivir/scanner"] == "TREND":
		virusscanner="vscan"
		scannerpath="/usr/local/trend"
		viruscmd="-za -d"
		alert="Infected:"
	elif baseConfig["proxy/antivir/scanner"] == "CLAMAV":
		virusscanner="clamdscan"
		scannerpath="/usr/bin"
		viruscmd="-v"
		alert="FOUND"
	elif baseConfig["proxy/antivir/scanner"] == "BITDEFENDER":
		virusscanner="bdc"
		scannerpath="/usr/bin"
		viruscmd="--all --arc --log=/etc/viralator/logs/bdc.log"
		alert="infected:"

if baseConfig.has_key("proxy/antivir/virusscanner") and baseConfig["proxy/antivir/virusscanner"]:
	virusscanner = baseConfig["proxy/antivir/virusscanner"]
if baseConfig.has_key("proxy/antivir/scannerpath") and baseConfig["proxy/antivir/scannerpath"]:
	scannerpath = baseConfig["proxy/antivir/scannerpath"]
if baseConfig.has_key("proxy/antivir/viruscmd") and baseConfig["proxy/antivir/viruscmd"]:
	viruscmd = baseConfig["proxy/antivir/viruscmd"]
if baseConfig.has_key("proxy/antivir/alert") and baseConfig["proxy/antivir/alert"]:
	alert = baseConfig["proxy/antivir/alert"]


print "virusscanner -> %s"%virusscanner
print "scannerpath -> %s"%scannerpath
print "viruscmd -> %s"%viruscmd
print "alert -> %s"%alert

if baseConfig.has_key('proxy/parent/host') and baseConfig['proxy/parent/host'] and baseConfig.has_key('proxy/parent/port') and baseConfig['proxy/parent/port']:
	print "proxyhost -> %s"%baseConfig['proxy/parent/host']
	print "proxyport -> %s"%baseConfig['proxy/parent/port']
@!@


# VÍRUS SCANNER PATHNAME
# Added this to make life easier when untainting code
# The path info to get to the antivirus executable
# Here bellow are some regular samples for each antivirus Viralator can deal with:
# INOCULATE => /usr/local/av
# AVP       => /usr/local/AvpLinux
# RAV       => /usr/bin 		  
# ANTIVIR   => /usr/local/AntiVir
# MCAFEE    => /usr/local/uvscan      
# SOPHOS    => /usr/local/bin   	  
# TREND     => /usr/local/trend   
# CLAMAV    => /usr/local/bin
# BITDEFENDER console free edition: /usr/bin
#scannerpath -> /usr/local/bin

# COMMAND OPTIONS
# Antivirus scanner commands samples
#
# INOCULATE => -FST -VER 
# AVP just doesn´t have any options
# RAV       => -UNZIP
# ANTIVIR   => -z	   		          
# MCAFEE    => --summary --noexpire --unzip 
# SOPHOS    => -archive -di -remove -nc
# TREND     => -za -d
# BITDEFENDER console free edition: --all --arc --log=/etc/viralator/logs/bdc.log
#viruscmd -> -v


# VIRUS FOUNDED ALERT MESSAGE
# This should change for an antivirus program to another.
# One should try the antivirus scanner of your choice running in the shell, and
# see the message that indicates that a virus was found.
# Bellow are some examples: if they don't work, you should try the scanner 
#by hand, with a test like EICAR virus, which is inoffensive, but is accused as
#a virus by any antivirus scanner.
# INOCULATE => Total Viruses Found
# AVP       => Known viruses :
# RAV       => Infected:
# ANTIVIR   => Infected:
# MCAFEE    => Infected: .....
# SOPHOS    => Infected:
# TREND     => Infected:
# CLAMAV => FOUND
# BITDEFENDER console free edition: infected:
alert -> FOUND

# DOWNLOAD PATHNAME
# Complete path to downloaded files
#downloads -> /var/www/default/proxy/downloads
downloads -> /var/www/downloads

# WEB PATH
# Web path to downloaded files
#downloadsdir -> /downloads
downloadsdir -> /downloads/

# DELETE ACTION
# the delete action parameter is no longer avaiable,
# since we believe that user privacy may be deny because
# of it. All files will be delete by default after user download

# Password phrase
# this parameter will be used to protect the paramenters passed through
# hidden fields in the forms created by Viralator. It's HIGHLY recommended
# that the system administrator changes the value bellow to something
# equally hard to guess
secret -> ThIs phrAse ShOUld bE DiFFiculT 2 gueSS.
