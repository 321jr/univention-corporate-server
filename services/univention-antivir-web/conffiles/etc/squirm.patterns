# squirm.patterns
#
# The ordering of lines is this file is critical
# Please see http://www.senet.com.au/squirm/ for examples
#

# Lines have the form:
# 	regex|regexi pattern replacement [[^]accelerator_string[$]]
# or
# 	abort filename_extension
#
#
# Examples of valid lines:
#
# regex  ^.*/n32e301\.exe$ http://www.mydomain/path_to/n32e301.exe
# regexi ^.*/n32e301\.exe$ http://www.mydomain/path_to/n32e301.exe
# regex  ^.*/n32e301\.exe$ http://www.mydomain/path_to/n32e301.exe n32e301.exe$
# abort .gif
# abort .html

abortregexi (^http://@%@hostname@%@/.*)
abortregexi (^http://@%@hostname@%@.@%@domainname@%@/.*)
@!@
for i in range(0,4):
	if baseConfig['interfaces/eth%s/address' % i ]:
		print 'abortregexi (^http://'+baseConfig['interfaces/eth%s/address' % i ]+'/.*)'
	for j in range(0,4):
		if baseConfig['interfaces/eth%s_%s/address' % (i,j) ]:
			print 'abortregexi (^http://'+baseConfig['interfaces/eth%s_%s/address' % (i,j) ]+'/.*)'
@!@

regexi (^.*\.exe$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.com$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.bat$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.wsh$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.cmd$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1

regexi (^.*\.dll$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.msi$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.scr$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.pif$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1

regexi (^.*\.zip$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.rar$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.gz$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.bz2$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.tar$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1

regexi (^.*\.doc$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.xls$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.ppt$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1
regexi (^.*\.pps$) http://@%@hostname@%@/cgi-bin/viralator.cgi?url=\1


