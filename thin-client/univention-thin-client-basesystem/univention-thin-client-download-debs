#!/bin/sh

usage ()
{
cat <<-EOL

`basename "$0"` (options)

options:
	-d destination
	-p package

EOL
exit 1
}


while [ "$#" -gt "0" ]; do
    case $1 in
        -d)
            destination=$2
            shift 2
            ;;
        -p)
            package="$package $2"
            shift 2
            ;;
        -h)
			usage
			;;
		-?)
			usage
			;;
		--help)
			usage
			;;
        *)
            package="$package $1"
			shift 1
			;;
    esac
done

if [ -z "$package" ] || [ -z "$package" ]; then
	usage
fi

mkdir -p $destination/partial
mv /etc/resolv.conf resolv.conf.BAK
echo "nameserver  192.168.0.3">/etc/resolv.conf
apt-get update
apt-get install --yes --force-yes --reinstall -d -o APT::Architecture=i386 -o Dir::Cache::archives=$destination -o APT::Cache=$destination $package
rm -Rf $destination/partial $destination/lock
mv resolv.conf.BAK /etc/resolv.conf

exit 0
