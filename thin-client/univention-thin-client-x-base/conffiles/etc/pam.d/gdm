# Warning: This file is auto-generated and might be overwritten by
#          univention-baseconfig.
#          Please edit the following file instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch
#          univention-baseconfig Ã¼berschrieben werden.
#          Bitte bearbeiten Sie an Stelle dessen die folgende Datei:
#
#   /etc/univention/templates/files/etc/pam.d/gdm
#

auth		required	pam_nologin.so
auth		required	pam_env.so
auth		sufficient	pam_unix.so
auth		required	pam_krb5.so forwardable use_first_pass
auth		required	pam_runasroot.so save_pass

account		sufficient	pam_unix.so
account		required	pam_ldap.so

password	required	pam_krb5.so

session		required	pam_unix.so
session		required	pam_limits.so
@!@
if baseConfig.get( 'thinclient/mount/homedir', 'yes' ).lower() in ( 'yes', 'true' ): 
	print '''
session		required	pam_runasroot.so program=/usr/sbin/univention-mount-homedir
session		required	pam_mkhomedir.so skel=/etc/skel umask=0066
session		required	pam_runasroot.so user program=/usr/share/univention-kde/univention-set-kdedirs
session		required	pam_env.so envfile=$HOME/.univention-environment
'''
else:
	print '''
session		required	pam_mkhomedir.so skel=/etc/skel umask=0066
'''
@!@

session		required	pam_runasroot.so export_pass program=/usr/bin/save_pass.sh demouser=demo silent

#auth		required	pam_runasroot.so demouser=demo demouserscript=/usr/share/univention-client-login/cleanup-demo.sh silent
#auth		required	pam_runasroot.so save_pass silent
#session	required	pam_runasroot.so export_pass program=/usr/bin/save_pass.sh demouser=demo silent
